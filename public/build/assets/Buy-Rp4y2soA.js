import{r as n,j as e,b as X}from"./app-BdEaxmMx.js";import{E as Q}from"./EmployeeLayout-BO_Cgqi-.js";import{u as z,T as H}from"./ThermalReceipt-DxkOYbEQ.js";import{u as V}from"./useCentralCashBalance-pDd_nO9Z.js";/* empty css            */function oe({user:N,currentDollarBalance:$=0,currentIQDBalance:k=0,currentCashBalance:S=0,openingDollarBalance:v=0,openingIQDBalance:w=0,openingCashBalance:_=0,exchangeRate:M=1500,transactions:W=[],quickReport:m={charges:0,payments:0,operations:0,dollars_bought:0}}){const[A,L]=n.useState($),[Z,R]=n.useState(k),[ee,C]=n.useState(S),[d,T]=n.useState({charges:m.charges,payments:m.payments,operations:m.operations,dollars_bought:m.dollars_bought}),{centralCashBalance:o,updateBalanceAfterTransaction:D}=V(S),[t,g]=n.useState({documentNumber:"",currentTime:new Date().toLocaleString("ar-EG"),dollarAmount:"",exchangeRate:M,commission:"0",notes:"",employeeName:N?.name||"Ø§Ù„Ù…ÙˆØ¸Ù Ø§Ù„Ø­Ø§Ù„ÙŠ"}),[u,x]=n.useState(!1),[E,p]=n.useState(""),[B,b]=n.useState(""),{showReceipt:O,receiptData:F,createBuyReceipt:I,printReceipt:U,closeReceipt:Y}=z();n.useEffect(()=>{const s=()=>{const c=new Date().toLocaleString("en-US",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit"});b(c)};s();const r=setInterval(s,1e3);return()=>clearInterval(r)},[]),n.useEffect(()=>{(()=>{const r=new Date,a=r.getFullYear().toString()+(r.getMonth()+1).toString().padStart(2,"0")+r.getDate().toString().padStart(2,"0"),c=Math.floor(Math.random()*1e3).toString().padStart(3,"0");p(`BUY${a}${c}`)})()},[]),n.useEffect(()=>{g(s=>({...s,documentNumber:E}))},[E]);const h=(s,r)=>{g(a=>({...a,[s]:r}))},f=()=>{const s=parseFloat(t.dollarAmount)||0,r=parseFloat(t.exchangeRate)||0;return r>0?s*r:0},l=()=>{const s=f(),r=parseFloat(t.commission)||0;return s+r},q=async()=>{if(!t.dollarAmount||parseFloat(t.dollarAmount)<=0){alert("ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ù…Ø¨Ù„Øº ØµØ­ÙŠØ­ Ø¨Ø§Ù„Ø¯ÙˆÙ„Ø§Ø±");return}const s=l();if(s>o){alert(`Ø§Ù„Ø±ØµÙŠØ¯ Ø§Ù„Ù†Ù‚Ø¯ÙŠ Ø§Ù„Ù…Ø±ÙƒØ²ÙŠ ØºÙŠØ± ÙƒØ§ÙÙŠ. Ø§Ù„Ù…Ø·Ù„ÙˆØ¨: ${Math.floor(s).toLocaleString()} Ø¯.Ø¹ØŒ Ø§Ù„Ù…ØªØ§Ø­: ${Math.floor(o).toLocaleString()} Ø¯.Ø¹`);return}x(!0);try{const r=await fetch("/employee/buy",{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]').getAttribute("content")},body:JSON.stringify({dollarAmount:t.dollarAmount,exchangeRate:t.exchangeRate,commission:t.commission,documentNumber:t.documentNumber,notes:t.notes})});if(r.ok){const a=await r.json();L(a.new_dollar_balance),R(a.new_iqd_balance),C(a.new_cash_balance),a.new_cash_balance!==void 0&&D(a.new_cash_balance),a.updated_report&&T({charges:a.updated_report.charges,payments:a.updated_report.payments,operations:a.updated_report.operations,dollars_bought:a.updated_report.dollars_bought}),g(j=>({...j,dollarAmount:"",commission:"0",notes:"",currentTime:new Date().toLocaleString("ar-EG")}));const c=new Date,i=c.getFullYear().toString()+(c.getMonth()+1).toString().padStart(2,"0")+c.getDate().toString().padStart(2,"0"),y=Math.floor(Math.random()*1e3).toString().padStart(3,"0");p(`BUY${i}${y}`),b(c.toLocaleString("en-US",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit"})),alert("ØªÙ… Ø¥Ø¬Ø±Ø§Ø¡ Ø¹Ù…Ù„ÙŠØ© Ø§Ù„Ø´Ø±Ø§Ø¡ Ø¨Ù†Ø¬Ø§Ø­!")}else{const a=await r.json();alert(a.message||"Ø­Ø¯Ø« Ø®Ø·Ø£")}}catch(r){console.error("Error:",r),alert("Ø­Ø¯Ø« Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø´Ø¨ÙƒØ©")}finally{x(!1)}},P=()=>{q()},G=async()=>{if(!t.dollarAmount||parseFloat(t.dollarAmount)<=0){alert("ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ù…Ø¨Ù„Øº ØµØ­ÙŠØ­ Ø¨Ø§Ù„Ø¯ÙˆÙ„Ø§Ø±");return}const s=l();if(s>o){alert(`Ø§Ù„Ø±ØµÙŠØ¯ Ø§Ù„Ù†Ù‚Ø¯ÙŠ Ø§Ù„Ù…Ø±ÙƒØ²ÙŠ ØºÙŠØ± ÙƒØ§ÙÙŠ. Ø§Ù„Ù…Ø·Ù„ÙˆØ¨: ${Math.floor(s).toLocaleString()} Ø¯.Ø¹ØŒ Ø§Ù„Ù…ØªØ§Ø­: ${Math.floor(o).toLocaleString()} Ø¯.Ø¹`);return}x(!0);try{const r=await fetch("/employee/buy",{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]').getAttribute("content")},body:JSON.stringify({dollarAmount:t.dollarAmount,exchangeRate:t.exchangeRate,commission:t.commission,documentNumber:t.documentNumber,notes:t.notes})});if(r.ok){const a=await r.json();if(L(a.new_dollar_balance),R(a.new_iqd_balance),C(a.new_cash_balance),a.new_cash_balance!==void 0&&D(a.new_cash_balance),a.updated_report&&T({charges:a.updated_report.charges,payments:a.updated_report.payments,operations:a.updated_report.operations,dollars_bought:a.updated_report.dollars_bought}),(await I({reference_number:t.documentNumber,dollar_amount:parseFloat(t.dollarAmount),exchange_rate:parseFloat(t.exchangeRate),iqd_amount:f(),commission:parseFloat(t.commission||0),total_amount:l(),notes:t.notes,customer_phone:null})).success){g(K=>({...K,dollarAmount:"",commission:"0",notes:"",currentTime:new Date().toLocaleString("ar-EG")}));const i=new Date,y=i.getFullYear().toString()+(i.getMonth()+1).toString().padStart(2,"0")+i.getDate().toString().padStart(2,"0"),j=Math.floor(Math.random()*1e3).toString().padStart(3,"0");p(`BUY${y}${j}`),b(i.toLocaleString("en-US",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit"})),alert("ØªÙ… Ø¥Ø¬Ø±Ø§Ø¡ Ø¹Ù…Ù„ÙŠØ© Ø§Ù„Ø´Ø±Ø§Ø¡ ÙˆØ¥Ù†Ø´Ø§Ø¡ Ø§Ù„ÙØ§ØªÙˆØ±Ø© Ø¨Ù†Ø¬Ø§Ø­!")}else alert("ØªÙ… Ø­ÙØ¸ Ø§Ù„Ø¹Ù…Ù„ÙŠØ© Ù„ÙƒÙ† ÙØ´Ù„ ÙÙŠ Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„ÙØ§ØªÙˆØ±Ø©")}else{const a=await r.json();alert(a.message||"Ø­Ø¯Ø« Ø®Ø·Ø£")}}catch(r){console.error("Error:",r),alert("Ø­Ø¯Ø« Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø´Ø¨ÙƒØ©")}finally{x(!1)}},J=()=>{X.visit("/employee/dashboard")};return e.jsxs(Q,{title:"Ø´Ø±Ø§Ø¡ Ø§Ù„Ø¯ÙˆÙ„Ø§Ø±",children:[e.jsxs("div",{className:"max-w-7xl mx-auto",children:[e.jsx("div",{className:"mb-6",children:e.jsxs("button",{onClick:J,className:"flex items-center gap-2 px-4 py-2 bg-gray-100 hover:bg-gray-200 text-gray-700 rounded-lg transition-colors duration-200",children:[e.jsx("span",{children:"â†"}),e.jsx("span",{children:"Ø§Ù„Ø¹ÙˆØ¯Ø© Ù„Ù„ØµÙØ­Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©"})]})}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsx("div",{className:"lg:col-span-1",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-sm border border-gray-200 p-6",children:[e.jsxs("div",{className:"text-center mb-6",children:[e.jsxs("div",{className:"w-20 h-20 bg-cyan-100 rounded-full flex items-center justify-center mx-auto mb-3",children:[e.jsx("img",{src:"/images/services/buy.png",alt:"Ø´Ø±Ø§Ø¡ Ø§Ù„Ø¯ÙˆÙ„Ø§Ø±",className:"w-12 h-12 object-contain",onError:s=>{s.target.style.display="none",s.target.nextSibling.style.display="block"}}),e.jsx("span",{className:"text-2xl text-cyan-600 hidden",children:"ğŸ›’"})]}),e.jsx("h2",{className:"text-xl font-bold text-gray-900",children:"Ø§Ù„Ø±ØµÙŠØ¯ Ø§Ù„Ø­Ø§Ù„ÙŠ"})]}),e.jsxs("div",{className:"space-y-4 mb-6",children:[e.jsxs("div",{className:"bg-cyan-50 rounded-xl p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-cyan-800 mb-2",children:"Ø§Ù„Ø±ØµÙŠØ¯ Ø§Ù„Ù…ØªØ¨Ù‚ÙŠ (Ø¯ÙˆÙ„Ø§Ø±)"}),e.jsxs("p",{className:"text-3xl font-bold text-cyan-700",children:["$",Math.floor(A).toLocaleString()]})]}),e.jsxs("div",{className:"bg-green-50 rounded-xl p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-green-800 mb-2",children:"Ø§Ù„Ø±ØµÙŠØ¯ Ø§Ù„Ù†Ù‚Ø¯ÙŠ Ø§Ù„Ù…Ø±ÙƒØ²ÙŠ"}),e.jsxs("p",{className:"text-3xl font-bold text-green-700",children:[Math.floor(o).toLocaleString()," Ø¯.Ø¹"]})]})]}),e.jsxs("div",{className:"space-y-3 mb-6",children:[e.jsx("h4",{className:"text-lg font-semibold text-gray-800",children:"Ø§Ù„Ø±ØµÙŠØ¯ Ø§Ù„Ø§ÙØªØªØ§Ø­ÙŠ"}),e.jsxs("div",{className:"bg-gray-50 rounded-xl p-4",children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Ø¨Ø§Ù„Ø¯ÙˆÙ„Ø§Ø±:"}),e.jsxs("span",{className:"font-bold text-gray-800",children:["$",v>0?Math.floor(v).toLocaleString():"0"]})]}),e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Ø¨Ø§Ù„Ø¯ÙŠÙ†Ø§Ø±:"}),e.jsxs("span",{className:"font-bold text-gray-800",children:[w>0?Math.floor(w).toLocaleString():"0"," Ø¯.Ø¹"]})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Ù†Ù‚Ø¯ÙŠ:"}),e.jsxs("span",{className:"font-bold text-gray-800",children:[_>0?Math.floor(_).toLocaleString():"0"," Ø¯.Ø¹"]})]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-4",children:"ØªÙ‚Ø±ÙŠØ± Ø´Ø§Ù…Ù„ - Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¹Ù…Ù„ÙŠØ§Øª"}),e.jsx("div",{className:"bg-red-50 rounded-lg p-4",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm text-red-700",children:"Ù…Ù†ØµØ±Ù:"}),e.jsxs("span",{className:"font-bold text-red-800",children:[d.charges>0?Math.floor(d.charges).toLocaleString():"0"," Ø¯.Ø¹"]})]})}),e.jsx("div",{className:"bg-blue-50 rounded-lg p-4",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm text-blue-700",children:"Ø¯ÙˆÙ„Ø§Ø± Ù…Ø´ØªØ±Ù‰:"}),e.jsxs("span",{className:"font-bold text-blue-800",children:[d.dollars_bought>0?Math.floor(d.dollars_bought).toLocaleString():"0"," $"]})]})}),e.jsx("div",{className:"bg-gray-50 rounded-lg p-4",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm text-gray-700",children:"Ø§Ù„Ø¹Ù…Ù„ÙŠØ§Øª:"}),e.jsx("span",{className:"font-bold text-gray-800",children:d.operations})]})})]}),e.jsx("button",{className:"w-full bg-blue-500 hover:bg-blue-600 text-white font-semibold py-3 px-4 rounded-xl transition-colors duration-200 mt-6",children:"ØªÙ‚Ø±ÙŠØ± Ù…ÙØµÙ„"})]})}),e.jsx("div",{className:"lg:col-span-2",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-sm border border-gray-200 p-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2 text-right",children:"Ø±Ù‚Ù… Ø§Ù„Ù…Ø±Ø¬Ø¹:"}),e.jsx("input",{type:"text",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-cyan-500 focus:border-transparent text-right",value:t.documentNumber,readOnly:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2 text-right",children:"Ø§Ù„ØªØ§Ø±ÙŠØ® ÙˆØ§Ù„ÙˆÙ‚Øª:"}),e.jsx("input",{type:"text",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-cyan-500 focus:border-transparent text-right",value:B,readOnly:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2 text-right",children:"Ù…Ø¯Ø®Ù„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª:"}),e.jsx("input",{type:"text",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-cyan-500 focus:border-transparent text-right bg-gray-50",value:N?.name||"ØºÙŠØ± Ù…Ø­Ø¯Ø¯",readOnly:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2 text-right",children:"Ø§Ù„Ù…Ø¨Ù„Øº Ø¨Ø§Ù„Ø¯ÙˆÙ„Ø§Ø±:"}),e.jsx("input",{type:"number",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-cyan-500 focus:border-transparent text-right",placeholder:"Ø§Ù„Ù…Ø¨Ù„Øº Ø¨Ø§Ù„Ø¯ÙˆÙ„Ø§Ø±",value:t.dollarAmount,max:A,onChange:s=>h("dollarAmount",s.target.value)}),t.dollarAmount&&l()>o&&e.jsxs("p",{className:"text-sm text-red-600 mt-1",children:["Ø§Ù„Ø±ØµÙŠØ¯ Ø§Ù„Ù†Ù‚Ø¯ÙŠ Ø§Ù„Ù…Ø±ÙƒØ²ÙŠ ØºÙŠØ± ÙƒØ§ÙÙŠ. Ø§Ù„Ù…Ø·Ù„ÙˆØ¨: ",Math.floor(l()).toLocaleString()," Ø¯.Ø¹ØŒ Ø§Ù„Ù…ØªØ§Ø­: ",Math.floor(o).toLocaleString()," Ø¯.Ø¹"]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2 text-right",children:"Ø³Ø¹Ø± Ø§Ù„ØµØ±Ù:"}),e.jsx("input",{type:"number",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-cyan-500 focus:border-transparent text-right",placeholder:`Ø§Ù„Ø³Ø¹Ø± Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠ: ${Math.floor(M)}`,value:Math.floor(t.exchangeRate),onChange:s=>h("exchangeRate",s.target.value)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2 text-right",children:"Ø§Ù„Ø¹Ù…ÙˆÙ„Ø© (Ø¨Ø§Ù„Ø¯ÙŠÙ†Ø§Ø± Ø§Ù„Ø¹Ø±Ø§Ù‚ÙŠ):"}),e.jsx("input",{type:"number",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-cyan-500 focus:border-transparent text-right",placeholder:"0 (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)",value:t.commission,onChange:s=>h("commission",s.target.value)})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6",children:[e.jsx("div",{className:"bg-cyan-50 rounded-xl p-4",children:e.jsxs("div",{className:"text-center",children:[e.jsx("span",{className:"text-sm font-semibold text-cyan-700",children:"Ø§Ù„Ù…Ø¨Ù„Øº Ø¨Ø§Ù„Ø¯ÙˆÙ„Ø§Ø±"}),e.jsxs("p",{className:"text-xl font-bold text-cyan-800",children:["$",Math.floor(parseFloat(t.dollarAmount||0)).toLocaleString()]})]})}),e.jsx("div",{className:"bg-orange-50 rounded-xl p-4",children:e.jsxs("div",{className:"text-center",children:[e.jsx("span",{className:"text-sm font-semibold text-orange-700",children:"Ø§Ù„Ù…Ø¨Ù„Øº Ø¨Ø§Ù„Ø¯ÙŠÙ†Ø§Ø±"}),e.jsxs("p",{className:"text-xl font-bold text-orange-800",children:[Math.floor(f()).toLocaleString()," Ø¯.Ø¹"]})]})}),e.jsx("div",{className:"bg-green-50 rounded-xl p-4",children:e.jsxs("div",{className:"text-center",children:[e.jsx("span",{className:"text-sm font-semibold text-green-700",children:"Ø§Ù„Ù…Ø¨Ù„Øº Ø§Ù„ÙƒÙ„ÙŠ"}),e.jsxs("p",{className:"text-xl font-bold text-green-800",children:[l()>0?Math.floor(l()).toLocaleString():"0"," Ø¯.Ø¹"]})]})})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2 text-right",children:"Ù…Ù„Ø§Ø­Ø¸Ø§Øª:"}),e.jsx("textarea",{className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-cyan-500 focus:border-transparent text-right",rows:"3",placeholder:"Ù…Ù„Ø§Ø­Ø¸Ø§Øª Ø¥Ø¶Ø§ÙÙŠØ©...",value:t.notes,onChange:s=>h("notes",s.target.value)})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("button",{onClick:G,disabled:u||!t.dollarAmount||l()>o,className:"bg-green-500 hover:bg-green-600 disabled:bg-gray-400 text-white font-semibold py-3 px-6 rounded-xl transition-colors duration-200 flex items-center justify-center",children:[e.jsx("span",{className:"ml-2",children:"ğŸ“„"}),u?"Ø¬Ø§Ø±ÙŠ Ø§Ù„Ù…Ø¹Ø§Ù„Ø¬Ø©...":"Ø­ÙØ¸ ÙˆØ·Ø¨Ø§Ø¹Ø©"]}),e.jsxs("button",{onClick:P,disabled:u||!t.dollarAmount||l()>o,className:"bg-cyan-500 hover:bg-cyan-600 disabled:bg-gray-400 text-white font-semibold py-3 px-6 rounded-xl transition-colors duration-200 flex items-center justify-center",children:[e.jsx("span",{className:"ml-2",children:"ğŸ’¾"}),u?"Ø¬Ø§Ø±ÙŠ Ø§Ù„Ù…Ø¹Ø§Ù„Ø¬Ø©...":"Ø­ÙØ¸"]})]})]})})]})]}),O&&F&&e.jsx(H,{receiptData:F,onClose:Y,onPrint:U})]})}export{oe as default};
