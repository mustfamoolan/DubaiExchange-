import{r as o,j as e,d as H}from"./app-DWkI_n4f.js";import{E as Q}from"./EmployeeLayout-DAHgDOm5.js";import{u as Z,T as q}from"./ThermalReceipt-B8ew9Q0Y.js";import{u as ee,N as te}from"./useNotification-CqnDnbxa.js";import{u as se}from"./useCentralCashBalance-DJoO0gvH.js";import{a as re}from"./generateUniqueReference-C4F3JMbQ.js";/* empty css            */function xe({user:x,currentBalance:D=0,currentCashBalance:F=0,transactions:g=[],openingBalance:y=0,openingCashBalance:ae=0,quickReport:h={charges:0,payments:0,operations:0}}){const[$,E]=o.useState(D),[n,j]=o.useState("charge"),[M,N]=o.useState(!1),[c,U]=o.useState({charges:h.charges,payments:h.payments,operations:h.operations});console.log("transactions:",g);const{centralCashBalance:v,updateBalanceAfterTransaction:O}=se(F),{showReceipt:A,receiptData:w,isCreatingReceipt:b,printReceipt:B,closeReceipt:I,createReceiptAndSave:P}=Z(),{notification:l,showSuccess:S,showError:i,closeNotification:V}=ee(),[a,u]=o.useState({amount:"",commission:"0",notes:""}),[d,C]=o.useState(!1),[p,_]=o.useState(""),[z,G]=o.useState("");o.useEffect(()=>{const t=()=>{const m=new Date().toLocaleString("en-US",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit"});G(m)};t();const s=setInterval(t,1e3);return()=>clearInterval(s)},[]),o.useEffect(()=>{(()=>{const s=re(x?.id);_(s)})()},[x?.id]);const k=t=>{if(!t)return"";const s=t.toString().replace(/,/g,"");if(isNaN(s)||s==="")return t;const f=parseFloat(s).toString().split(".");return f[0]=f[0].replace(/\B(?=(\d{3})+(?!\d))/g,","),f.join(".")},J=t=>t.toString().replace(/,/g,""),R=(t,s)=>{const r=J(s);(r===""||/^\d*\.?\d*$/.test(r))&&u(m=>({...m,[t]:r}))},K=(t,s)=>{u(r=>({...r,[t]:s}))},T=()=>{const t=parseFloat(a.amount)||0,s=parseFloat(a.commission)||0;return s>0?t+s:t},W=()=>{N(!0)},L=async t=>{if(!a.amount||parseFloat(a.amount)<=0){i("ÿÆÿ∑ÿ£ ŸÅŸä ÿßŸÑŸÖÿØÿÆŸÑÿßÿ™","Ÿäÿ±ÿ¨Ÿâ ÿ•ÿØÿÆÿßŸÑ ŸÖÿ®ŸÑÿ∫ ÿµÿ≠Ÿäÿ≠");return}C(!0);try{const s=await fetch(`/employee/rafidain/${t}`,{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]').getAttribute("content")},body:JSON.stringify({...a,reference_number:p})});if(s.ok){const r=await s.json();return E(r.new_balance),r.new_cash_balance!==void 0&&O(r.new_cash_balance),r.updated_report&&U({charges:r.updated_report.charges,payments:r.updated_report.payments,operations:r.updated_report.operations}),Y(),S("ÿ™ŸÖ ÿ•ŸÜÿ¨ÿßÿ≤ ÿßŸÑÿπŸÖŸÑŸäÿ© ÿ®ŸÜÿ¨ÿßÿ≠!",`ÿ™ŸÖ ${t==="charge"?"ÿßŸÑÿ¥ÿ≠ŸÜ":"ÿßŸÑÿØŸÅÿπ"} ÿ®ŸÜÿ¨ÿßÿ≠ Ÿàÿ™ÿ≠ÿØŸäÿ´ ÿßŸÑÿ±ÿµŸäÿØ`),{success:!0,result:r}}else{const r=await s.json();return i("ŸÅÿ¥ŸÑ ŸÅŸä ÿßŸÑÿπŸÖŸÑŸäÿ©",r.message||"ÿ≠ÿØÿ´ ÿÆÿ∑ÿ£ ÿ∫Ÿäÿ± ŸÖÿ™ŸàŸÇÿπ"),{success:!1,error:r}}}catch(s){return console.error("Error:",s),i("ÿÆÿ∑ÿ£ ŸÅŸä ÿßŸÑÿ¥ÿ®ŸÉÿ©","ÿ™ÿπÿ∞ÿ± ÿßŸÑÿßÿ™ÿµÿßŸÑ ÿ®ÿßŸÑÿÆÿßÿØŸÖÿå Ÿäÿ±ÿ¨Ÿâ ÿßŸÑŸÖÿ≠ÿßŸàŸÑÿ© ŸÖÿ±ÿ© ÿ£ÿÆÿ±Ÿâ"),{success:!1,error:s}}finally{C(!1)}},X=async()=>{if(!a.amount||parseFloat(a.amount)<=0){i("ÿÆÿ∑ÿ£ ŸÅŸä ÿßŸÑŸÖÿØÿÆŸÑÿßÿ™","Ÿäÿ±ÿ¨Ÿâ ÿ•ÿØÿÆÿßŸÑ ŸÖÿ®ŸÑÿ∫ ÿµÿ≠Ÿäÿ≠ ŸÇÿ®ŸÑ ÿßŸÑŸÖÿ™ÿßÿ®ÿπÿ©");return}const t={transaction_type:n,reference_number:p,amount:a.amount,commission:a.commission,notes:a.notes,customer_phone:null};(await P(()=>L(n),t,"rafidain")).success&&S("ÿ™ŸÖ ÿ•ŸÜÿ¨ÿßÿ≤ ÿßŸÑÿπŸÖŸÑŸäÿ© ÿ®ŸÜÿ¨ÿßÿ≠!","ÿ™ŸÖ ÿ≠ŸÅÿ∏ ÿßŸÑŸÖÿπÿßŸÖŸÑÿ© Ÿàÿ•ÿπÿØÿßÿØ ÿßŸÑŸÅÿßÿ™Ÿàÿ±ÿ© ŸÑŸÑÿ∑ÿ®ÿßÿπÿ©")},Y=()=>{u({amount:"",commission:"",notes:""});const t=new Date,s=t.getFullYear().toString()+(t.getMonth()+1).toString().padStart(2,"0")+t.getDate().toString().padStart(2,"0"),r=Math.floor(Math.random()*1e3).toString().padStart(3,"0");_(`RAF${s}${r}`)};return e.jsx(Q,{title:"ŸÖÿµÿ±ŸÅ ÿßŸÑÿ±ÿßŸÅÿØŸäŸÜ",children:e.jsxs("div",{className:"max-w-7xl mx-auto",children:[e.jsx("div",{className:"mb-6",children:e.jsxs("button",{onClick:()=>H.visit("/employee/dashboard"),className:"flex items-center gap-2 px-6 py-3 bg-blue-600 hover:bg-blue-700 text-white font-semibold rounded-lg transition-colors duration-200 shadow-md",children:[e.jsx("span",{children:"‚Üê"}),e.jsx("span",{children:"ÿßŸÑÿπŸàÿØÿ© ŸÑŸÑÿµŸÅÿ≠ÿ© ÿßŸÑÿ±ÿ¶Ÿäÿ≥Ÿäÿ©"})]})}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsx("div",{className:"lg:col-span-1",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-sm border border-gray-200 p-6",children:[e.jsxs("div",{className:"text-center mb-6",children:[e.jsxs("div",{className:"w-20 h-20 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-3",children:[e.jsx("img",{src:"/images/services/rafidain-bank.png",alt:"ŸÖÿµÿ±ŸÅ ÿßŸÑÿ±ÿßŸÅÿØŸäŸÜ",className:"w-12 h-12 object-contain",onError:t=>{t.target.style.display="none",t.target.nextSibling.style.display="block"}}),e.jsx("span",{className:"text-2xl text-green-600 hidden",children:"üèõÔ∏è"})]}),e.jsx("h2",{className:"text-xl font-bold text-gray-900",children:"ŸÖÿµÿ±ŸÅ ÿßŸÑÿ±ÿßŸÅÿØŸäŸÜ"})]}),e.jsxs("div",{className:"space-y-4 mb-6",children:[e.jsxs("div",{className:"bg-green-50 rounded-xl p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-green-800 mb-2",children:"ÿßŸÑÿ±ÿµŸäÿØ ÿßŸÑŸÖÿ™ÿ®ŸÇŸä ŸÑŸÖÿµÿ±ŸÅ ÿßŸÑÿ±ÿßŸÅÿØŸäŸÜ"}),e.jsxs("p",{className:"text-3xl font-bold text-green-700",children:[Math.floor($).toLocaleString("en-US")," ÿØ.ÿπ"]})]}),e.jsxs("div",{className:"bg-green-50 rounded-xl p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-green-800 mb-2",children:"ÿßŸÑÿ±ÿµŸäÿØ ÿßŸÑŸÜŸÇÿØŸä ÿßŸÑŸÖÿ±ŸÉÿ≤Ÿä"}),e.jsxs("p",{className:"text-3xl font-bold text-green-700",children:[isNaN(v)?"0":Math.floor(v).toLocaleString("en-US")," ÿØ.ÿπ"]})]})]}),e.jsxs("div",{className:"space-y-3 mb-6",children:[e.jsx("h4",{className:"text-lg font-semibold text-gray-800",children:"ÿßŸÑÿ±ÿµŸäÿØ ÿßŸÑÿßŸÅÿ™ÿ™ÿßÿ≠Ÿä"}),e.jsx("div",{className:"bg-gray-50 rounded-xl p-4",children:e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsx("span",{className:"text-sm font-medium text-gray-700",children:"ŸÖÿµÿ±ŸÅ ÿßŸÑÿ±ÿßŸÅÿØŸäŸÜ:"}),e.jsxs("span",{className:"font-bold text-gray-800",children:[y>0?Math.floor(y).toLocaleString("en-US"):"0"," ÿØ.ÿπ"]})]})})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-4",children:"ÿ™ŸÇÿ±Ÿäÿ± ÿ¥ÿßŸÖŸÑ - ÿ¨ŸÖŸäÿπ ÿßŸÑÿπŸÖŸÑŸäÿßÿ™"}),e.jsx("div",{className:"bg-red-50 rounded-lg p-4",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm text-red-700",children:"ÿ¥ÿ≠ŸÜ:"}),e.jsxs("span",{className:"font-bold text-red-800",children:[c.charges>0?Math.floor(c.charges).toLocaleString("en-US"):"0"," ÿØ.ÿπ"]})]})}),e.jsx("div",{className:"bg-green-50 rounded-lg p-4",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm text-green-700",children:"ÿØŸÅÿπ:"}),e.jsxs("span",{className:"font-bold text-green-800",children:[c.payments>0?Math.floor(c.payments).toLocaleString("en-US"):"0"," ÿØ.ÿπ"]})]})}),e.jsx("div",{className:"bg-gray-50 rounded-lg p-4",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm text-gray-700",children:"ÿßŸÑÿπŸÖŸÑŸäÿßÿ™:"}),e.jsx("span",{className:"font-bold text-gray-800",children:c.operations})]})})]}),e.jsx("button",{onClick:W,className:"w-full bg-blue-500 hover:bg-blue-600 text-white font-semibold py-3 px-4 rounded-xl transition-colors duration-200 mt-6",children:"ÿπÿ±ÿ∂ ÿ≥ÿ¨ŸÑ ÿßŸÑÿ≠ÿ±ŸÉÿßÿ™"})]})}),e.jsx("div",{className:"lg:col-span-2",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-sm border border-gray-200 p-6",children:[e.jsxs("div",{className:"flex mb-6 bg-gray-100 rounded-lg p-1",children:[e.jsx("button",{onClick:()=>j("charge"),className:`px-6 py-3 rounded-lg font-semibold flex-1 transition-all duration-300 transform ${n==="charge"?"bg-red-500 text-white shadow-lg scale-105":"bg-transparent text-gray-700 hover:bg-gray-200"}`,children:"üí∞ ÿ¥ÿ≠ŸÜ"}),e.jsx("button",{onClick:()=>j("payment"),className:`px-6 py-3 rounded-lg font-semibold flex-1 transition-all duration-300 transform ${n==="payment"?"bg-green-500 text-white shadow-lg scale-105":"bg-transparent text-gray-700 hover:bg-gray-200"}`,children:"üí∏ ÿØŸÅÿπ"})]}),e.jsxs("div",{className:`mb-6 p-4 rounded-lg border-l-4 ${n==="charge"?"bg-red-50 border-red-500":"bg-green-50 border-green-500"}`,children:[e.jsx("h3",{className:`font-semibold ${n==="charge"?"text-red-800":"text-green-800"}`,children:n==="charge"?"üî¥ Ÿàÿ∂ÿπ ÿßŸÑÿ¥ÿ≠ŸÜ ŸÜÿ¥ÿ∑":"üü¢ Ÿàÿ∂ÿπ ÿßŸÑÿØŸÅÿπ ŸÜÿ¥ÿ∑"}),e.jsx("p",{className:`text-sm ${n==="charge"?"text-red-600":"text-green-600"}`,children:n==="charge"?"ÿ£ÿØÿÆŸÑ ÿ®ŸäÿßŸÜÿßÿ™ ÿπŸÖŸÑŸäÿ© ÿßŸÑÿ¥ÿ≠ŸÜ":"ÿ£ÿØÿÆŸÑ ÿ®ŸäÿßŸÜÿßÿ™ ÿπŸÖŸÑŸäÿ© ÿßŸÑÿØŸÅÿπ"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2 text-right",children:"ÿ±ŸÇŸÖ ÿßŸÑŸÖÿ±ÿ¨ÿπ:"}),e.jsx("input",{type:"text",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent text-right",value:p,readOnly:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2 text-right",children:"ÿßŸÑÿ™ÿßÿ±ŸäÿÆ ŸàÿßŸÑŸàŸÇÿ™:"}),e.jsx("input",{type:"text",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent text-right",value:z,readOnly:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2 text-right",children:"ŸÖÿØÿÆŸÑ ÿßŸÑÿ®ŸäÿßŸÜÿßÿ™:"}),e.jsx("input",{type:"text",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent text-right bg-gray-50",value:x?.name||"ÿ∫Ÿäÿ± ŸÖÿ≠ÿØÿØ",readOnly:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2 text-right",children:"ÿßŸÑŸÖÿ®ŸÑÿ∫:"}),e.jsx("input",{type:"text",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent text-right",placeholder:"ÿßŸÑŸÖÿ®ŸÑÿ∫",value:a.amount?k(a.amount):"",onChange:t=>R("amount",t.target.value)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2 text-right",children:"ÿßŸÑÿπŸÖŸàŸÑÿ©:"}),e.jsx("input",{type:"text",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent text-right",placeholder:"ÿßŸÑÿπŸÖŸàŸÑÿ©",value:a.commission?k(a.commission):"",onChange:t=>R("commission",t.target.value)})]})]}),e.jsx("div",{className:`rounded-xl p-4 mb-6 ${n==="charge"?"bg-red-50 border border-red-200":"bg-green-50 border border-green-200"}`,children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:`text-lg font-semibold ${n==="charge"?"text-red-800":"text-green-800"}`,children:n==="charge"?"ÿ•ÿ¨ŸÖÿßŸÑŸä ÿßŸÑÿ¥ÿ≠ŸÜ:":"ÿ•ÿ¨ŸÖÿßŸÑŸä ÿßŸÑÿØŸÅÿπ:"}),e.jsxs("span",{className:`text-2xl font-bold ${n==="charge"?"text-red-700":"text-green-700"}`,children:[T()>0?Math.floor(T()).toLocaleString("en-US"):"0"," ÿØ.ÿπ"]})]})}),e.jsxs("div",{className:"mb-6",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2 text-right",children:"ŸÖŸÑÿßÿ≠ÿ∏ÿßÿ™:"}),e.jsx("textarea",{className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent text-right",rows:"3",placeholder:"ŸÖŸÑÿßÿ≠ÿ∏ÿßÿ™ ÿ•ÿ∂ÿßŸÅŸäÿ©...",value:a.notes,onChange:t=>K("notes",t.target.value)})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("button",{onClick:X,disabled:d||b,className:"bg-green-500 hover:bg-green-600 disabled:bg-gray-400 text-white font-semibold py-3 px-6 rounded-xl transition-colors duration-200 flex items-center justify-center",children:[e.jsx("span",{className:"ml-2",children:"üìÑ"}),d||b?"ÿ¨ÿßÿ±Ÿä ÿßŸÑŸÖÿπÿßŸÑÿ¨ÿ©...":"ÿ≠ŸÅÿ∏ Ÿàÿ∑ÿ®ÿßÿπÿ©"]}),e.jsxs("button",{onClick:()=>L(n),disabled:d||b,className:"bg-green-500 hover:bg-green-600 disabled:bg-gray-400 text-white font-semibold py-3 px-6 rounded-xl transition-colors duration-200 flex items-center justify-center",children:[e.jsx("span",{className:"ml-2",children:"üíæ"}),d?"ÿ¨ÿßÿ±Ÿä ÿßŸÑŸÖÿπÿßŸÑÿ¨ÿ©...":"ÿ≠ŸÅÿ∏"]})]})]})})]}),M&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-xl max-w-4xl w-full max-h-[95vh] overflow-y-auto",children:[e.jsx("div",{className:"bg-gradient-to-r from-blue-500 to-blue-600 px-6 py-4 rounded-t-2xl",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("h2",{className:"text-xl font-bold text-white flex items-center",children:[e.jsx("span",{className:"text-2xl mr-3",children:"ÔøΩ"}),"ÿ≥ÿ¨ŸÑ ÿßŸÑÿ≠ÿ±ŸÉÿßÿ™ - ŸÖÿµÿ±ŸÅ ÿßŸÑÿ±ÿßŸÅÿØŸäŸÜ"]}),e.jsx("button",{onClick:()=>N(!1),className:"text-white hover:text-gray-200 text-3xl font-bold transition-colors duration-200",children:"√ó"})]})}),e.jsx("div",{className:"p-6 bg-gray-50",children:e.jsxs("table",{className:"min-w-full border-collapse",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"bg-gray-100",children:[e.jsx("th",{className:"border border-gray-400 px-2 py-2 text-center text-sm font-bold",children:"ÿßŸÑÿ±ŸÇŸÖ ÿßŸÑŸÖÿ±ÿ¨ÿπŸä"}),e.jsx("th",{className:"border border-gray-400 px-2 py-2 text-center text-sm font-bold",children:"ŸÜŸàÿπ ÿßŸÑÿ≠ÿ±ŸÉÿ©"}),e.jsx("th",{className:"border border-gray-400 px-2 py-2 text-center text-sm font-bold",children:"ÿßŸÑŸÖÿ®ŸÑÿ∫"}),e.jsx("th",{className:"border border-gray-400 px-2 py-2 text-center text-sm font-bold",children:"ÿßŸÑÿπŸÖŸàŸÑÿ©"}),e.jsx("th",{className:"border border-gray-400 px-2 py-2 text-center text-sm font-bold",children:"ÿßŸÑÿ±ÿµŸäÿØ ÿ®ÿπÿØ ÿßŸÑÿ≠ÿ±ŸÉÿ©"}),e.jsx("th",{className:"border border-gray-400 px-2 py-2 text-center text-sm font-bold",children:"ŸÖŸÑÿßÿ≠ÿ∏ÿßÿ™"}),e.jsx("th",{className:"border border-gray-400 px-2 py-2 text-center text-sm font-bold",children:"ÿ™ÿßÿ±ŸäÿÆ ÿßŸÑÿ≠ÿ±ŸÉÿ©"})]})}),e.jsx("tbody",{children:g.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:7,className:"text-center py-6 text-gray-500",children:"ŸÑÿß ÿ™Ÿàÿ¨ÿØ ÿ≠ÿ±ŸÉÿßÿ™ ŸÖÿ≥ÿ¨ŸÑÿ©"})}):g.map((t,s)=>e.jsxs("tr",{className:s%2===0?"bg-white":"bg-gray-50",children:[e.jsx("td",{className:"border border-gray-400 px-2 py-1 text-center text-xs",children:t.reference_number}),e.jsx("td",{className:"border border-gray-400 px-2 py-1 text-center text-xs",children:t.transaction_type==="charge"?"ÿ¥ÿ≠ŸÜ":"ÿØŸÅÿπ"}),e.jsx("td",{className:"border border-gray-400 px-2 py-1 text-center text-xs font-bold text-green-700",children:parseFloat(t.amount).toLocaleString("en-US")}),e.jsx("td",{className:"border border-gray-400 px-2 py-1 text-center text-xs text-blue-700",children:parseFloat(t.commission).toLocaleString("en-US")}),e.jsx("td",{className:"border border-gray-400 px-2 py-1 text-center text-xs text-gray-800",children:parseFloat(t.new_balance).toLocaleString("en-US")}),e.jsx("td",{className:"border border-gray-400 px-2 py-1 text-center text-xs",children:t.notes||"-"}),e.jsx("td",{className:"border border-gray-400 px-2 py-1 text-center text-xs",children:t.created_at?new Date(t.created_at).toLocaleString("ar-EG"):"-"})]},t.id||s))})]})})]})}),A&&w&&e.jsx(q,{receiptData:w,onClose:I,onPrint:B}),e.jsx(te,{isOpen:l.isOpen,type:l.type,title:l.title,message:l.message,autoClose:l.autoClose,autoCloseDelay:l.autoCloseDelay,onClose:V})]})})}export{xe as default};
