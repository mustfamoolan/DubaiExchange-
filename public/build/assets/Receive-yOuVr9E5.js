import{r as o,j as e,d as ke}from"./app-DlBU8k81.js";import{E as De}from"./EmployeeLayout-dGZ30CLf.js";import{u as Ee,T as Fe}from"./ThermalReceipt-BNJMsiSH.js";import{u as Le}from"./useCentralCashBalance-CCTx77Ft.js";import{u as Te}from"./useCentralDollarBalance-F494OEn6.js";import{u as Me,R as Oe}from"./ReceiveExchangeThermalReceipt-BQpNyawU.js";import{c as V}from"./generateUniqueReference-C4F3JMbQ.js";import{u as Be,N as qe}from"./useNotification-Bb6HduJY.js";/* empty css            */function Ye({user:b,currentBalance:H=0,currentCashBalance:Y=0,currentCentralDollarBalance:Z=0,currentDollarBalance:ee=0,openingBalance:D=0,openingCashBalance:Ae=0,openingDollarBalance:Ie=0,transactions:Pe=[],quickReport:f={received_today:0,operations:0,total_received:0,total_exchanged:0}}){const[Ge,E]=o.useState(H),[Ke,F]=o.useState(ee||0),[te,L]=o.useState(!1),[d,T]=o.useState({received_today:f.received_today,operations:f.operations,total_received:f.total_received,total_exchanged:f.total_exchanged}),{centralCashBalance:re,updateBalanceAfterTransaction:M}=Le(Y),{centralDollarBalance:se,updateBalanceAfterTransaction:O}=Te(Z),{showReceipt:ae,receiptData:B,printReceipt:ne,closeReceipt:oe}=Ee(),{showReceipt:le,receiptData:q,createReceiptAndSave:ce,printReceipt:ie,closeReceipt:de}=Me(),{notification:u,showSuccess:me,showError:A,showWarning:I,closeNotification:ue}=Be(),[r,m]=o.useState({documentNumber:"",currentTime:new Date().toLocaleString("ar-EG"),receivedFrom:"",selectedCustomer:null,amount:"",currency:"",exchange_rate:"",description:"",receiverName:b?.name||"الموظف الحالي",notes:""}),[i,P]=o.useState(""),[N,G]=o.useState([]),[w,y]=o.useState([]),[_,x]=o.useState(!1),[xe,K]=o.useState(!1),[ge,j]=o.useState(!1),[l,g]=o.useState({name:"",phone:"",opening_balance_iqd:"0",opening_balance_usd:"0"}),[v,U]=o.useState(!1),[W,C]=o.useState(""),[he,S]=o.useState("");o.useEffect(()=>{const t=()=>{const n=new Date().toLocaleString("en-US",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit"});S(n)};t();const a=setInterval(t,1e3);return()=>clearInterval(a)},[]),o.useEffect(()=>{(()=>{const a=V(b?.id);C(a)})()},[b?.id]),o.useEffect(()=>{m(t=>({...t,documentNumber:W}))},[W]);const pe=["دينار عراقي","دولار أمريكي"],X=t=>{if(!t)return"";const a=t.toString().replace(/,/g,"");if(isNaN(a)||a==="")return t;const c=parseFloat(a).toString().split(".");return c[0]=c[0].replace(/\B(?=(\d{3})+(?!\d))/g,","),c.join(".")},p=t=>t.toString().replace(/,/g,""),$=(t,a)=>{const s=p(a);(s===""||/^\d*\.?\d*$/.test(s))&&m(n=>({...n,[t]:s}))},R=(t,a)=>{m(s=>{const n={...s,[t]:a};return t==="currency"&&a==="دينار عراقي"&&(n.exchange_rate="1"),t==="currency"&&a==="دولار أمريكي"&&(n.exchange_rate="1"),n})},be=async()=>{K(!0);try{const t=await fetch("/api/employee/customers/search",{method:"GET",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]')?.getAttribute("content")}});if(t.ok){const a=await t.json();G(a.customers||[]),y(a.customers||[])}}catch(t){console.error("Error fetching customers:",t)}finally{K(!1)}},fe=t=>{if(P(t),m(s=>({...s,receivedFrom:t,selectedCustomer:null})),t.trim()===""){y(N),x(!1);return}const a=N.filter(s=>s.name.toLowerCase().includes(t.toLowerCase())||s.phone.includes(t)||s.customer_code.toLowerCase().includes(t.toLowerCase()));y(a),x(!0)},Q=t=>{m(a=>({...a,receivedFrom:t.name,selectedCustomer:t})),P(t.name),x(!1)},ye=async()=>{try{console.log("إضافة عميل جديد - البيانات المرسلة:",{name:l.name,phone:l.phone,opening_balance_iqd:l.opening_balance_iqd||"0",opening_balance_usd:l.opening_balance_usd||"0"});const t=await fetch("/api/employee/customers",{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]')?.getAttribute("content")},body:JSON.stringify({name:l.name,phone:l.phone,opening_balance_iqd:l.opening_balance_iqd||"0",opening_balance_usd:l.opening_balance_usd||"0"})});if(console.log("استجابة الخادم - حالة:",t.status),t.ok){const a=await t.json();console.log("نجح إنشاء العميل:",a);const s=a.customer;G(n=>[s,...n]),y(n=>[s,...n]),Q(s),j(!1),g({name:"",phone:"",opening_balance_iqd:"0",opening_balance_usd:"0"}),me("نجاح العملية","تم إضافة العميل بنجاح!")}else{const a=await t.json();console.error("خطأ في إنشاء العميل:",a),A("خطأ",a.message||"حدث خطأ في إضافة العميل")}}catch(t){console.error("خطأ في الشبكة:",t),A("خطأ في الشبكة","حدث خطأ في الشبكة")}},z=()=>{g(t=>({...t,name:i})),j(!0),x(!1)};o.useEffect(()=>{be()},[]),o.useEffect(()=>{const t=a=>{_&&!a.target.closest(".relative")&&x(!1)};return document.addEventListener("mousedown",t),()=>{document.removeEventListener("mousedown",t)}},[_]);const[h,je]=o.useState(null),ve=async()=>{try{const t=await fetch("/employee/receive/detailed-report",{method:"GET",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]').getAttribute("content")}});if(t.ok){const a=await t.json();return je(a),a}else return console.error("فشل في جلب التقرير المفصل"),null}catch(t){return console.error("خطأ في جلب التقرير:",t),null}},Ne=async()=>{L(!0),h||await ve()},we=async()=>{const t=r.currency!=="دينار عراقي"&&r.currency!=="دولار أمريكي";if(!r.receivedFrom||!r.amount||!r.currency||t&&!r.exchange_rate)throw new Error("يرجى ملء جميع الحقول المطلوبة");if(parseFloat(r.amount)<=0)throw new Error("يرجى إدخال مبلغ صحيح");if(t&&parseFloat(r.exchange_rate)<=0)throw new Error("يرجى إدخال سعر صرف صحيح");const a=await fetch("/employee/receive",{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]').getAttribute("content")},body:JSON.stringify({documentNumber:r.documentNumber,receivedFrom:r.receivedFrom,selectedCustomer:r.selectedCustomer,amount:p(r.amount),currency:r.currency,exchange_rate:p(r.exchange_rate||"1"),description:r.description,beneficiary:"الصندوق النقدي",notes:r.notes})});if(a.ok){const s=await a.json();E(s.new_balance),s.new_cash_balance!==void 0&&M(s.new_cash_balance),s.new_central_dollar_balance!==void 0&&O(s.new_central_dollar_balance),s.new_dollar_balance!==void 0&&s.new_dollar_balance!==null&&F(s.new_dollar_balance),s.updated_report&&T({received_today:s.updated_report.received_today,operations:s.updated_report.operations,total_received:s.updated_report.total_received,total_exchanged:s.updated_report.total_exchanged}),m(Re=>({...Re,receivedFrom:"",amount:"",currency:"",exchange_rate:"",description:"",notes:"",currentTime:new Date().toLocaleString("ar-EG")}));const n=new Date,c=n.getFullYear().toString()+(n.getMonth()+1).toString().padStart(2,"0")+n.getDate().toString().padStart(2,"0"),k=Math.floor(Math.random()*1e3).toString().padStart(3,"0");return C(`REC${c}${k}`),S(n.toLocaleString("en-US",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit"})),s}else{let s="حدث خطأ";try{s=(await a.json()).message||"حدث خطأ"}catch{const c=await a.text();console.error("خطأ في الاستجابة:",c),s="خطأ في الخادم"}throw new Error(s)}},_e=async()=>{const t=r.currency!=="دينار عراقي"&&r.currency!=="دولار أمريكي";if(!r.receivedFrom||!r.amount||!r.currency||t&&!r.exchange_rate){I("تحذير","يرجى ملء جميع الحقول المطلوبة");return}if(parseFloat(r.amount)<=0){I("تحذير","يرجى إدخال مبلغ صحيح");return}if(t&&parseFloat(r.exchange_rate)<=0){alert("يرجى إدخال سعر صرف صحيح");return}U(!0);try{const a=await fetch("/employee/receive",{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]').getAttribute("content")},body:JSON.stringify({documentNumber:r.documentNumber,receivedFrom:r.receivedFrom,selectedCustomer:r.selectedCustomer,amount:p(r.amount),currency:r.currency,exchange_rate:p(r.exchange_rate||"1"),description:r.description,beneficiary:"الصندوق النقدي",notes:r.notes})});if(a.ok){const s=await a.json();E(s.new_balance),s.new_cash_balance!==void 0&&M(s.new_cash_balance),s.new_central_dollar_balance!==void 0&&O(s.new_central_dollar_balance),s.new_dollar_balance!==void 0&&s.new_dollar_balance!==null&&F(s.new_dollar_balance),s.updated_report&&T({received_today:s.updated_report.received_today,operations:s.updated_report.operations,total_received:s.updated_report.total_received,total_exchanged:s.updated_report.total_exchanged}),m(k=>({...k,receivedFrom:"",amount:"",currency:"",exchange_rate:"",description:"",notes:"",currentTime:new Date().toLocaleString("ar-EG")}));const n=V(b?.id);return C(n),S(new Date().toLocaleString("en-US",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit"})),alert("تم حفظ سند القبض بنجاح!"),s}else{let s="حدث خطأ";try{s=(await a.json()).message||"حدث خطأ"}catch{const c=await a.text();console.error("خطأ في الاستجابة:",c),s="خطأ في الخادم"}return alert(s),{success:!1,error:s}}}catch(a){return console.error("Error:",a),alert("حدث خطأ في الشبكة"),{success:!1,error:a.message}}finally{U(!1)}},Ce=async()=>{const t=r.currency!=="دينار عراقي"&&r.currency!=="دولار أمريكي";if(!r.receivedFrom||!r.amount||!r.currency||t&&!r.exchange_rate){alert("يرجى ملء جميع الحقول المطلوبة");return}const a=Math.floor(parseFloat(r.amount||0)*parseFloat(r.exchange_rate||1)),s=await ce(we,{reference_number:r.documentNumber,employee_name:r.receiverName,person_name:r.receivedFrom,currency:r.currency,amount:r.amount,exchange_rate:r.exchange_rate||"1",amount_in_iqd:a,beneficiary:"الصندوق النقدي",description:r.description,notes:r.notes},"receive");s&&s.success&&console.log("تم حفظ سند القبض وإنشاء الفاتورة المخصصة بنجاح")},Se=()=>{ke.visit("/employee/dashboard")},J=()=>{const t=r.currency!=="دينار عراقي"&&r.currency!=="دولار أمريكي";return r.receivedFrom&&r.amount&&r.currency&&(!t||r.exchange_rate)};return e.jsxs(De,{title:"عمليات القبض",children:[e.jsxs("div",{className:"max-w-7xl mx-auto",children:[e.jsx("div",{className:"mb-6",children:e.jsxs("button",{onClick:Se,className:"flex items-center gap-2 px-6 py-3 bg-blue-600 hover:bg-blue-700 text-white font-semibold rounded-lg transition-colors duration-200 shadow-md",children:[e.jsx("span",{children:"←"}),e.jsx("span",{children:"العودة للصفحة الرئيسية"})]})}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsx("div",{className:"lg:col-span-1",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-sm border border-gray-200 p-6",children:[e.jsxs("div",{className:"text-center mb-6",children:[e.jsx("div",{className:"w-20 h-20 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-3",children:e.jsx("span",{className:"text-2xl text-green-600",children:"📝"})}),e.jsx("h2",{className:"text-xl font-bold text-gray-900",children:"سند القبض"})]}),e.jsxs("div",{className:"space-y-4 mb-6",children:[e.jsxs("div",{className:"bg-green-50 rounded-xl p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-green-800 mb-2",children:"الرصيد النقدي المركزي"}),e.jsxs("p",{className:"text-3xl font-bold text-green-700",children:[Math.floor(re).toLocaleString()," د.ع"]})]}),e.jsxs("div",{className:"bg-purple-50 rounded-xl p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-purple-800 mb-2",children:"الرصيد المركزي للدولار"}),e.jsxs("p",{className:"text-3xl font-bold text-purple-700",children:["$",Math.floor(se).toLocaleString()]})]}),e.jsx("div",{className:"bg-gray-50 rounded-xl p-4",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm font-medium text-gray-700",children:"الرصيد الافتتاحي:"}),e.jsxs("span",{className:"font-bold text-gray-800",children:[D>0?Math.floor(D).toLocaleString():"0"," د.ع"]})]})})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-4",children:"تقرير شامل - جميع العمليات"}),e.jsx("div",{className:"bg-green-50 rounded-lg p-4",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm text-green-700",children:"مستلم اليوم:"}),e.jsxs("span",{className:"font-bold text-green-800",children:[d.received_today>0?Math.floor(d.received_today).toLocaleString():"0"," د.ع"]})]})}),e.jsx("div",{className:"bg-blue-50 rounded-lg p-4",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm text-blue-700",children:"إجمالي المستلم:"}),e.jsxs("span",{className:"font-bold text-blue-800",children:[d.total_received>0?Math.floor(d.total_received).toLocaleString():"0"," د.ع"]})]})}),e.jsx("div",{className:"bg-red-50 rounded-lg p-4",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm text-red-700",children:"إجمالي المصروف:"}),e.jsxs("span",{className:"font-bold text-red-800",children:[d.total_exchanged>0?Math.floor(d.total_exchanged).toLocaleString():"0"," د.ع"]})]})}),e.jsx("div",{className:"bg-gray-50 rounded-lg p-4",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm text-gray-700",children:"العمليات:"}),e.jsx("span",{className:"font-bold text-gray-800",children:d.operations})]})})]}),e.jsx("button",{onClick:Ne,className:"w-full bg-blue-500 hover:bg-blue-600 text-white font-semibold py-3 px-4 rounded-xl transition-colors duration-200 mt-6",children:"تقرير مفصل"})]})}),e.jsx("div",{className:"lg:col-span-2",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-sm border border-gray-200 p-6",children:[e.jsx("div",{className:"text-center mb-8",children:e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"سند قبض"})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2 text-right",children:"رقم المستند:"}),e.jsx("input",{type:"text",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent text-right bg-gray-50",value:r.documentNumber,readOnly:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2 text-right",children:"التاريخ والوقت:"}),e.jsx("input",{type:"text",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent text-right bg-gray-50",value:he,readOnly:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2 text-right",children:"اسم المستلم:"}),e.jsx("input",{type:"text",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent text-right bg-gray-50",value:r.receiverName,readOnly:!0})]}),e.jsxs("div",{className:"relative",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2 text-right",children:"استلمت من السيد: *"}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"text",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent text-right",placeholder:"ابحث عن عميل أو أدخل اسم جديد...",value:i,onChange:t=>fe(t.target.value),onFocus:()=>{N.length>0&&i&&x(!0)}}),xe&&e.jsx("div",{className:"absolute left-3 top-1/2 transform -translate-y-1/2",children:e.jsx("div",{className:"animate-spin h-4 w-4 border-2 border-green-500 border-t-transparent rounded-full"})}),r.selectedCustomer&&e.jsx("div",{className:"absolute left-3 top-1/2 transform -translate-y-1/2",children:e.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full"})})]}),_&&e.jsx("div",{className:"absolute z-10 w-full mt-1 bg-white border border-gray-300 rounded-lg shadow-lg max-h-60 overflow-y-auto",children:w.length>0?e.jsxs(e.Fragment,{children:[w.map(t=>e.jsx("div",{className:"px-4 py-2 hover:bg-gray-100 cursor-pointer border-b border-gray-100 text-right",onClick:()=>Q(t),children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("div",{className:"text-left",children:e.jsx("span",{className:"text-xs text-gray-500",children:t.customer_code})}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-gray-900",children:t.name}),e.jsx("div",{className:"text-sm text-gray-600",children:t.phone})]})]})},t.id)),i&&!w.some(t=>t.name.toLowerCase()===i.toLowerCase())&&e.jsxs("div",{className:"px-4 py-3 bg-green-50 hover:bg-green-100 cursor-pointer border-t border-green-200 text-center text-green-700 font-medium",onClick:z,children:[e.jsx("svg",{className:"w-4 h-4 inline-block ml-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})}),'إضافة عميل جديد: "',i,'"']})]}):i?e.jsxs("div",{className:"px-4 py-3 bg-green-50 hover:bg-green-100 cursor-pointer text-center text-green-700 font-medium",onClick:z,children:[e.jsx("svg",{className:"w-4 h-4 inline-block ml-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})}),'إضافة عميل جديد: "',i,'"']}):e.jsx("div",{className:"px-4 py-3 text-center text-gray-500",children:"لا توجد عملاء"})}),r.selectedCustomer&&e.jsxs("div",{className:"mt-2 p-3 bg-green-50 border border-green-200 rounded-lg text-right",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("div",{className:"text-left",children:e.jsx("span",{className:"text-xs font-medium text-green-700",children:r.selectedCustomer.customer_code})}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-green-900",children:r.selectedCustomer.name}),e.jsx("div",{className:"text-sm text-green-700",children:r.selectedCustomer.phone})]})]}),e.jsxs("div",{className:"mt-2 grid grid-cols-2 gap-2 text-xs",children:[e.jsxs("div",{className:"text-center bg-white p-2 rounded",children:[e.jsx("div",{className:"text-gray-600",children:"الرصيد USD"}),e.jsxs("div",{className:"font-bold text-green-700",children:["$",r.selectedCustomer.current_usd_balance||"0.00"]})]}),e.jsxs("div",{className:"text-center bg-white p-2 rounded",children:[e.jsx("div",{className:"text-gray-600",children:"الرصيد IQD"}),e.jsxs("div",{className:"font-bold text-green-700",children:[parseInt(r.selectedCustomer.current_iqd_balance||0).toLocaleString()," د.ع"]})]})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2 text-right",children:"المبلغ: *"}),e.jsx("input",{type:"text",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent text-right",placeholder:"أدخل المبلغ",value:r.amount?X(r.amount):"",onChange:t=>$("amount",t.target.value)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2 text-right",children:"العملة: *"}),e.jsxs("select",{className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent text-right",value:r.currency,onChange:t=>R("currency",t.target.value),children:[e.jsx("option",{value:"",children:"اختر العملة"}),pe.map((t,a)=>e.jsx("option",{value:t,children:t},a))]})]}),r.currency!=="دينار عراقي"&&r.currency!=="دولار أمريكي"&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2 text-right",children:"سعر الصرف: *"}),e.jsx("input",{type:"text",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent text-right",value:r.exchange_rate?X(r.exchange_rate):"",onChange:t=>$("exchange_rate",t.target.value),placeholder:"أدخل سعر الصرف"})]}),r.amount&&r.exchange_rate&&r.currency!=="دينار عراقي"&&r.currency!=="دولار أمريكي"&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2 text-right",children:"المبلغ بالدينار العراقي:"}),e.jsxs("div",{className:"w-full px-3 py-2 bg-gray-100 border border-gray-300 rounded-lg text-right",children:[Math.floor(parseFloat(r.amount||0)*parseFloat(r.exchange_rate||0)).toLocaleString()," د.ع"]})]})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2 text-right",children:"وذلك عن:"}),e.jsx("textarea",{className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent text-right",rows:"3",placeholder:"تفاصيل السبب أو الملاحظات...",value:r.description,onChange:t=>R("description",t.target.value)})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2 text-right",children:"ملاحظات إضافية:"}),e.jsx("textarea",{className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent text-right",rows:"2",placeholder:"ملاحظات أخرى...",value:r.notes,onChange:t=>R("notes",t.target.value)})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("button",{onClick:Ce,disabled:v||!J(),className:"bg-blue-500 hover:bg-blue-600 disabled:bg-gray-400 text-white font-semibold py-3 px-6 rounded-xl transition-colors duration-200 flex items-center justify-center",children:[e.jsx("span",{className:"ml-2",children:"🖨️"}),v?"جاري المعالجة...":"حفظ وطباعة"]}),e.jsxs("button",{onClick:_e,disabled:v||!J(),className:"bg-green-500 hover:bg-green-600 disabled:bg-gray-400 text-white font-semibold py-3 px-6 rounded-xl transition-colors duration-200 flex items-center justify-center",children:[e.jsx("span",{className:"ml-2",children:"💾"}),v?"جاري المعالجة...":"حفظ"]})]})]})})]})]}),ae&&B&&e.jsx(Fe,{receiptData:B,onClose:oe,onPrint:ne}),le&&q&&e.jsx(Oe,{receiptData:q,receiptType:"receive",onClose:de,onPrint:ie}),te&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-xl max-w-4xl w-full max-h-[90vh] overflow-y-auto",children:[e.jsx("div",{className:"p-6 border-b border-gray-200",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h2",{className:"text-xl font-bold text-gray-900",children:"التقرير المفصل - سندات القبض"}),e.jsx("button",{onClick:()=>L(!1),className:"text-gray-500 hover:text-gray-700 text-2xl",children:"×"})]})}),e.jsx("div",{className:"p-6",children:h?e.jsxs("div",{children:[e.jsxs("div",{className:"mb-6 grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"bg-green-50 p-4 rounded-lg",children:[e.jsx("h3",{className:"font-semibold text-green-800",children:"إجمالي المبلغ"}),e.jsxs("p",{className:"text-2xl font-bold text-green-700",children:[h.summary?.total_amount?.toLocaleString()||"0"," د.ع"]})]}),e.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg",children:[e.jsx("h3",{className:"font-semibold text-blue-800",children:"عدد العمليات"}),e.jsx("p",{className:"text-2xl font-bold text-blue-700",children:h.summary?.total_transactions||0})]}),e.jsxs("div",{className:"bg-purple-50 p-4 rounded-lg",children:[e.jsx("h3",{className:"font-semibold text-purple-800",children:"عدد العملات"}),e.jsx("p",{className:"text-2xl font-bold text-purple-700",children:h.summary?.currencies?.length||0})]})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full table-auto",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-2 text-right",children:"رقم المستند"}),e.jsx("th",{className:"px-4 py-2 text-right",children:"المستلم من"}),e.jsx("th",{className:"px-4 py-2 text-right",children:"المبلغ"}),e.jsx("th",{className:"px-4 py-2 text-right",children:"العملة"}),e.jsx("th",{className:"px-4 py-2 text-right",children:"المستفيد"}),e.jsx("th",{className:"px-4 py-2 text-right",children:"التاريخ"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-200",children:h.transactions?.map((t,a)=>e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-4 py-2",children:t.document_number}),e.jsx("td",{className:"px-4 py-2",children:t.received_from}),e.jsx("td",{className:"px-4 py-2 font-semibold",children:Number(t.amount).toLocaleString()}),e.jsx("td",{className:"px-4 py-2",children:t.currency}),e.jsx("td",{className:"px-4 py-2",children:t.beneficiary}),e.jsx("td",{className:"px-4 py-2",children:t.formatted_date})]},a))})]})})]}):e.jsxs("div",{className:"text-center py-8",children:[e.jsx("div",{className:"inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-blue-500"}),e.jsx("p",{className:"mt-2 text-gray-600",children:"جاري تحميل التقرير..."})]})})]})}),ge&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:e.jsx("div",{className:"bg-white rounded-lg max-w-md w-full max-h-[90vh] overflow-y-auto",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("button",{onClick:()=>j(!1),className:"text-gray-400 hover:text-gray-600",children:e.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})}),e.jsx("h2",{className:"text-xl font-bold text-gray-900",children:"إضافة عميل جديد"})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2 text-right",children:"اسم العميل: *"}),e.jsx("input",{type:"text",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent text-right",placeholder:"أدخل اسم العميل",value:l.name,onChange:t=>g(a=>({...a,name:t.target.value}))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2 text-right",children:"رقم الهاتف: *"}),e.jsx("input",{type:"tel",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent text-right",placeholder:"أدخل رقم الهاتف",value:l.phone,onChange:t=>g(a=>({...a,phone:t.target.value}))})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2 text-right",children:"الرصيد الافتتاحي USD"}),e.jsx("input",{type:"number",step:"0.01",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent text-right",placeholder:"0.00 (يمكن أن يكون سالب)",value:l.opening_balance_usd,onChange:t=>g(a=>({...a,opening_balance_usd:t.target.value}))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2 text-right",children:"الرصيد الافتتاحي IQD"}),e.jsx("input",{type:"number",step:"1",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent text-right",placeholder:"0 (يمكن أن يكون سالب)",value:l.opening_balance_iqd,onChange:t=>g(a=>({...a,opening_balance_iqd:t.target.value}))})]})]}),e.jsxs("div",{className:"flex space-x-3 space-x-reverse pt-4",children:[e.jsx("button",{onClick:()=>j(!1),className:"flex-1 px-4 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50 transition-colors",children:"إلغاء"}),e.jsx("button",{onClick:ye,disabled:!l.name||!l.phone,className:"flex-1 px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:"إضافة العميل"})]})]})]})})}),e.jsx(qe,{isOpen:u.isOpen,type:u.type,title:u.title,message:u.message,autoClose:u.autoClose,autoCloseDelay:u.autoCloseDelay,onClose:ue})]})}export{Ye as default};
