import{r as x,j as e,L as w,a as T,b as _}from"./app-BWOxe5WU.js";import{A as k}from"./AdminLayout-CHBKgFMQ.js";/* empty css            */function Q({employee:d,openingBalances:C=[]}){const[p,L]=x.useState(new Date().toISOString().split("T")[0]),[r,g]=x.useState(!1),[b,h]=x.useState(""),[F,m]=x.useState(!1),[u,S]=x.useState(""),s=C.find(t=>t.status==="active"),a=!!s;if(!d)return e.jsx(k,{title:"الرصيد الافتتاحي",children:e.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"w-16 h-16 mx-auto bg-red-100 rounded-full flex items-center justify-center mb-4",children:e.jsx("svg",{className:"w-8 h-8 text-red-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z"})})}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"لم يتم العثور على بيانات الموظف"}),e.jsx("p",{className:"text-gray-500 mb-4",children:"تأكد من صحة الرابط أو اتصالك بقاعدة البيانات"}),e.jsx(w,{href:route("admin.opening-balance"),className:"bg-blue-500 hover:bg-blue-600 text-white px-4 py-2 rounded-lg transition-colors duration-200",children:"العودة إلى قائمة الموظفين"})]})})});const{data:l,setData:i,post:z,reset:f}=T({user_id:d.id,opening_date:a?s.opening_date:p,naqa:a&&s.naqa||"",rafidain:a&&s.rafidain||"",rashid:a&&s.rashid||"",zain_cash:a&&s.zain_cash||"",super_key:a&&s.super_key||"",usd_cash:a&&s.usd_cash||"",exchange_rate:a&&s.exchange_rate||"1400",notes:a&&s.notes||""});x.useEffect(()=>{a&&!r&&i({user_id:d.id,opening_date:s.opening_date,naqa:s.naqa||"",rafidain:s.rafidain||"",rashid:s.rashid||"",zain_cash:s.zain_cash||"",super_key:s.super_key||"",usd_cash:s.usd_cash||"",exchange_rate:s.exchange_rate||"1400",notes:s.notes||""})},[a,s,r]);const j=[{id:"naqa",name:"نقدا",icon:"💵",color:"bg-green-100 text-green-600"},{id:"rafidain",name:"مصرف الرافدين",icon:"🏛️",color:"bg-green-100 text-green-600"},{id:"rashid",name:"مصرف الرشيد",icon:"🏦",color:"bg-blue-100 text-blue-600"},{id:"zain_cash",name:"زين كاش",icon:"📱",color:"bg-purple-100 text-purple-600"},{id:"super_key",name:"سوبر كي",icon:"💳",color:"bg-yellow-100 text-yellow-600"}],o={name:"الدولار الأمريكي",icon:"💲",color:"bg-indigo-100 text-indigo-600"},c=(t,n)=>{a&&!r||i(t,n)},$=t=>{S(t),m(!0)},q=()=>{if(b!=="1234"){alert("رمز التأكيد غير صحيح");return}const t=u==="inactive"?route("opening-balance.deactivate",s.id):route("opening-balance.activate",s.id);_.patch(t,{},{onSuccess:()=>{alert(`تم ${u==="inactive"?"إلغاء تفعيل":"تفعيل"} الرصيد بنجاح`),m(!1),h(""),window.location.reload()},onError:()=>{alert("حدث خطأ أثناء تغيير حالة الرصيد")}})},D=()=>{g(!0)},E=()=>{g(!1),a&&i({user_id:d.id,opening_date:s.opening_date,naqa:s.naqa||"",rafidain:s.rafidain||"",rashid:s.rashid||"",zain_cash:s.zain_cash||"",super_key:s.super_key||"",usd_cash:s.usd_cash||"",exchange_rate:s.exchange_rate||"1400",notes:s.notes||""})},v=()=>{let t=0;return j.forEach(n=>{t+=parseFloat(l[n.id])||0}),t},y=()=>parseFloat(l.usd_cash)||0,M=()=>{const t=v(),n=y()*parseFloat(l.exchange_rate);return t+(n||0)},N=()=>{a&&r?_.patch(route("opening-balance.update",s.id),l,{onSuccess:()=>{alert("تم تحديث الأرصدة بنجاح!"),g(!1),window.location.reload()},onError:t=>{console.error("Validation errors:",t),Object.keys(t).length>0&&alert("يرجى التحقق من البيانات المدخلة")}}):a||z(route("opening-balance.store"),{onSuccess:()=>{alert("تم حفظ الأرصدة بنجاح!"),f(),window.location.reload()},onError:t=>{console.error("Validation errors:",t),t.employee_id?alert("خطأ في بيانات الموظف: "+t.employee_id):Object.keys(t).length>0&&alert("يرجى التحقق من البيانات المدخلة")}})},B=()=>{a&&!r||(f(),i("exchange_rate","1400"),i("opening_date",p),i("user_id",d.id))};return e.jsxs(k,{title:"الأرصدة الافتتاحية",children:[e.jsxs("div",{className:"space-y-4 lg:space-y-6",children:[e.jsxs("div",{className:"bg-white rounded-lg lg:rounded-xl shadow-sm border border-gray-200 p-4 lg:p-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4 mb-4 lg:mb-6",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl lg:text-2xl font-bold text-gray-900",children:"الأرصدة الافتتاحية"}),e.jsxs("div",{className:"flex items-center gap-2 mt-2",children:[e.jsx("span",{className:"text-sm text-gray-500",children:"الموظف:"}),e.jsx("span",{className:"px-3 py-1 bg-blue-100 text-blue-800 rounded-full text-sm font-medium",children:d.name})]})]}),e.jsx("button",{className:"bg-red-500 hover:bg-red-600 text-white px-4 py-2 rounded-lg transition-colors duration-200 text-sm lg:text-base",children:e.jsx(w,{href:"/admin/opening-balance",className:"flex items-center gap-2",children:"← الرجوع"})})]}),e.jsxs("div",{className:"max-w-xs",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2 text-right",children:"التاريخ:"}),e.jsx("input",{type:"date",value:l.opening_date,onChange:t=>{a&&!r||(L(t.target.value),i("opening_date",t.target.value))},disabled:a&&!r,className:`w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent text-right text-sm lg:text-base ${a&&!r?"bg-gray-100 cursor-not-allowed":""}`})]})]}),a&&e.jsxs("div",{className:"bg-green-50 border border-green-200 rounded-lg lg:rounded-xl p-4 lg:p-6",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx("div",{className:"w-10 h-10 bg-green-100 rounded-full flex items-center justify-center",children:e.jsx("svg",{className:"w-6 h-6 text-green-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-green-800",children:"يوجد رصيد افتتاحي فعال"}),e.jsxs("p",{className:"text-sm text-green-600",children:["تاريخ الإنشاء: ",new Date(s.opening_date).toLocaleDateString("ar-EG")]})]}),e.jsx("div",{className:"mr-auto",children:e.jsx("span",{className:"px-3 py-1 bg-green-100 text-green-800 rounded-full text-sm font-medium",children:"فعال"})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-4",children:[e.jsxs("div",{className:"bg-white rounded-lg p-3 border border-green-200",children:[e.jsx("div",{className:"text-sm text-gray-600",children:"إجمالي الدينار العراقي"}),e.jsxs("div",{className:"text-lg font-bold text-gray-900",children:[((parseFloat(s.naqa)||0)+(parseFloat(s.rafidain)||0)+(parseFloat(s.rashid)||0)+(parseFloat(s.zain_cash)||0)+(parseFloat(s.super_key)||0)).toLocaleString()," د.ع"]})]}),e.jsxs("div",{className:"bg-white rounded-lg p-3 border border-green-200",children:[e.jsx("div",{className:"text-sm text-gray-600",children:"الدولار الأمريكي"}),e.jsxs("div",{className:"text-lg font-bold text-gray-900",children:["$",(parseFloat(s.usd_cash)||0).toLocaleString()]})]}),e.jsxs("div",{className:"bg-white rounded-lg p-3 border border-green-200",children:[e.jsx("div",{className:"text-sm text-gray-600",children:"الإجمالي النهائي"}),e.jsxs("div",{className:"text-lg font-bold text-green-600",children:[(()=>{const t=(parseFloat(s.naqa)||0)+(parseFloat(s.rafidain)||0)+(parseFloat(s.rashid)||0)+(parseFloat(s.zain_cash)||0)+(parseFloat(s.super_key)||0),n=(parseFloat(s.usd_cash)||0)*(parseFloat(s.exchange_rate)||1400);return(t+n).toLocaleString()})()," د.ع"]}),e.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:["(",((parseFloat(s.naqa)||0)+(parseFloat(s.rafidain)||0)+(parseFloat(s.rashid)||0)+(parseFloat(s.zain_cash)||0)+(parseFloat(s.super_key)||0)).toLocaleString()," د.ع +",((parseFloat(s.usd_cash)||0)*(parseFloat(s.exchange_rate)||1400)).toLocaleString()," د.ع)"]})]})]}),e.jsx("div",{className:"flex flex-wrap gap-3",children:r?e.jsxs(e.Fragment,{children:[e.jsxs("button",{onClick:N,className:"bg-green-500 hover:bg-green-600 text-white px-4 py-2 rounded-lg transition-colors duration-200 flex items-center gap-2 text-sm",children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),"حفظ التغييرات"]}),e.jsxs("button",{onClick:E,className:"bg-gray-500 hover:bg-gray-600 text-white px-4 py-2 rounded-lg transition-colors duration-200 flex items-center gap-2 text-sm",children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})}),"إلغاء"]})]}):e.jsxs(e.Fragment,{children:[e.jsxs("button",{onClick:D,className:"bg-blue-500 hover:bg-blue-600 text-white px-4 py-2 rounded-lg transition-colors duration-200 flex items-center gap-2 text-sm",children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})}),"تعديل المبالغ"]}),e.jsxs("button",{onClick:()=>$("inactive"),className:"bg-yellow-500 hover:bg-yellow-600 text-white px-4 py-2 rounded-lg transition-colors duration-200 flex items-center gap-2 text-sm",children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M18.364 18.364A9 9 0 005.636 5.636m12.728 12.728L5.636 5.636m12.728 12.728L5.636 5.636"})}),"إلغاء التفعيل"]})]})})]}),"                ",e.jsxs("div",{className:"bg-white rounded-lg lg:rounded-xl shadow-sm border border-gray-200 overflow-hidden",children:[e.jsxs("div",{className:"bg-gradient-to-r from-blue-500 to-blue-600 text-white p-3 lg:p-4",children:[e.jsxs("div",{className:"hidden lg:grid lg:grid-cols-12 gap-4 text-center font-semibold",children:[e.jsx("div",{className:"col-span-1 text-sm",children:"الرمز"}),e.jsx("div",{className:"col-span-4 text-sm",children:"اسم الحساب"}),e.jsx("div",{className:"col-span-2 text-sm",children:"نوع العملة"}),e.jsx("div",{className:"col-span-3 text-sm",children:"المبلغ"}),e.jsx("div",{className:"col-span-2 text-sm",children:"سعر الصرف"})]}),e.jsx("div",{className:"lg:hidden text-center font-semibold text-sm",children:"إدارة الأرصدة الافتتاحية"})]}),e.jsxs("div",{className:"divide-y divide-gray-200",children:[j.map(t=>e.jsxs("div",{className:"p-3 lg:p-4 hover:bg-gray-50 transition-colors",children:[e.jsxs("div",{className:"hidden lg:grid lg:grid-cols-12 gap-4 items-center",children:[e.jsx("div",{className:"col-span-1 text-center",children:e.jsx("div",{className:`w-8 h-8 lg:w-10 lg:h-10 rounded-full ${t.color} flex items-center justify-center mx-auto`,children:e.jsx("span",{className:"text-base lg:text-lg",children:t.icon})})}),e.jsx("div",{className:"col-span-4 text-right font-medium text-gray-900 text-sm lg:text-base",children:t.name}),e.jsx("div",{className:"col-span-2 text-center",children:e.jsx("span",{className:"px-2 py-1 lg:px-3 lg:py-1 bg-green-100 text-green-800 rounded-full text-xs lg:text-sm font-medium",children:"دينار عراقي"})}),e.jsx("div",{className:"col-span-3",children:e.jsx("input",{type:"number",placeholder:"0",disabled:a&&!r,className:`w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent text-center text-sm lg:text-base ${a&&!r?"bg-gray-100 cursor-not-allowed":""}`,value:l[t.id],onChange:n=>c(t.id,n.target.value)})}),e.jsx("div",{className:"col-span-2 text-center text-gray-500 text-sm",children:"-"})]}),e.jsxs("div",{className:"lg:hidden space-y-3",children:[e.jsxs("div",{className:"flex items-center space-x-3 space-x-reverse",children:[e.jsx("div",{className:`w-8 h-8 rounded-full ${t.color} flex items-center justify-center flex-shrink-0`,children:e.jsx("span",{className:"text-sm",children:t.icon})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"font-medium text-gray-900 text-sm",children:t.name}),e.jsx("p",{className:"text-xs text-gray-500",children:"دينار عراقي"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1 text-right",children:"المبلغ:"}),e.jsx("input",{type:"number",placeholder:"0",disabled:a&&!r,className:`w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent text-center text-sm ${a&&!r?"bg-gray-100 cursor-not-allowed":""}`,value:l[t.id],onChange:n=>c(t.id,n.target.value)})]})]})]},t.id)),e.jsxs("div",{className:"p-3 lg:p-4 hover:bg-gray-50 transition-colors bg-blue-50/30",children:[e.jsxs("div",{className:"hidden lg:grid lg:grid-cols-12 gap-4 items-center",children:[e.jsx("div",{className:"col-span-1 text-center",children:e.jsx("div",{className:`w-8 h-8 lg:w-10 lg:h-10 rounded-full ${o.color} flex items-center justify-center mx-auto`,children:e.jsx("span",{className:"text-base lg:text-lg",children:o.icon})})}),e.jsx("div",{className:"col-span-4 text-right font-medium text-gray-900 text-sm lg:text-base",children:o.name}),e.jsx("div",{className:"col-span-2 text-center",children:e.jsx("span",{className:"px-2 py-1 lg:px-3 lg:py-1 bg-blue-100 text-blue-800 rounded-full text-xs lg:text-sm font-medium",children:"دولار أمريكي"})}),e.jsx("div",{className:"col-span-3",children:e.jsx("input",{type:"number",placeholder:"0",disabled:a&&!r,className:`w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent text-center text-sm lg:text-base ${a&&!r?"bg-gray-100 cursor-not-allowed":""}`,value:l.usd_cash,onChange:t=>c("usd_cash",t.target.value)})}),e.jsx("div",{className:"col-span-2",children:e.jsx("input",{type:"number",placeholder:"1400",disabled:a&&!r,className:`w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent text-center bg-yellow-50 text-sm lg:text-base ${a&&!r?"bg-gray-100 cursor-not-allowed":"bg-yellow-50"}`,value:l.exchange_rate,onChange:t=>c("exchange_rate",t.target.value)})})]}),e.jsxs("div",{className:"lg:hidden space-y-3",children:[e.jsxs("div",{className:"flex items-center space-x-3 space-x-reverse",children:[e.jsx("div",{className:`w-8 h-8 rounded-full ${o.color} flex items-center justify-center flex-shrink-0`,children:e.jsx("span",{className:"text-sm",children:o.icon})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"font-medium text-gray-900 text-sm",children:o.name}),e.jsx("p",{className:"text-xs text-gray-500",children:"دولار أمريكي"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1 text-right",children:"المبلغ ($):"}),e.jsx("input",{type:"number",placeholder:"0",disabled:a&&!r,className:`w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent text-center text-sm ${a&&!r?"bg-gray-100 cursor-not-allowed":""}`,value:l.usd_cash,onChange:t=>c("usd_cash",t.target.value)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1 text-right",children:"سعر الصرف:"}),e.jsx("input",{type:"number",placeholder:"1400",disabled:a&&!r,className:`w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent text-center text-sm ${a&&!r?"bg-gray-100 cursor-not-allowed":"bg-yellow-50"}`,value:l.exchange_rate,onChange:t=>c("exchange_rate",t.target.value)})]})]})]})]})]}),e.jsx("div",{className:"bg-gray-50 p-3 lg:p-4 border-t-2 border-gray-200",children:e.jsxs("div",{className:"flex flex-col lg:flex-row lg:items-center lg:justify-between gap-3 lg:gap-4",children:[e.jsxs("div",{className:"text-center lg:text-right",children:[e.jsx("h3",{className:"text-base lg:text-lg font-bold text-gray-900",children:"الإجمالي النهائي"}),e.jsx("p",{className:"text-xs lg:text-sm text-gray-500",children:"مجموع جميع الأرصدة (دينار عراقي + دولار بسعر الصرف)"})]}),e.jsx("div",{className:"flex justify-center",children:e.jsxs("div",{className:"bg-gradient-to-r from-blue-500 to-blue-600 text-white rounded-lg p-3 lg:p-4 shadow-lg min-w-[200px] text-center",children:[e.jsxs("div",{className:"text-lg lg:text-2xl font-bold",children:[M().toLocaleString()," د.ع"]}),e.jsxs("div",{className:"text-xs opacity-80 mt-1",children:["(",v().toLocaleString()," + ",(y()*parseFloat(l.exchange_rate||1400)).toLocaleString(),")"]})]})})]})})]}),!a&&e.jsxs("div",{className:"flex flex-col sm:flex-row gap-3 lg:gap-4 justify-center",children:[e.jsx("button",{onClick:B,className:"bg-red-500 hover:bg-red-600 text-white px-6 lg:px-8 py-2.5 lg:py-3 rounded-lg font-semibold transition-colors duration-200 flex items-center justify-center gap-2 text-sm lg:text-base",children:"🗑️ مسح"}),e.jsx("button",{onClick:N,className:"bg-green-500 hover:bg-green-600 text-white px-6 lg:px-8 py-2.5 lg:py-3 rounded-lg font-semibold transition-colors duration-200 flex items-center justify-center gap-2 text-sm lg:text-base",children:"💾 حفظ الأرصدة"})]})]}),F&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-md w-full mx-4",children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-4 text-right",children:["تأكيد ",u==="inactive"?"إلغاء التفعيل":"التفعيل"]}),e.jsx("p",{className:"text-gray-600 mb-4 text-right",children:"يرجى إدخال رمز التأكيد لمتابعة العملية"}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2 text-right",children:"رمز التأكيد:"}),e.jsx("input",{type:"password",value:b,onChange:t=>h(t.target.value),placeholder:"أدخل رمز التأكيد",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent text-center",autoFocus:!0})]}),e.jsxs("div",{className:"flex gap-3 justify-end",children:[e.jsx("button",{onClick:()=>{m(!1),h("")},className:"bg-gray-500 hover:bg-gray-600 text-white px-4 py-2 rounded-lg transition-colors duration-200",children:"إلغاء"}),e.jsx("button",{onClick:q,className:"bg-blue-500 hover:bg-blue-600 text-white px-4 py-2 rounded-lg transition-colors duration-200",children:"تأكيد"})]})]})})]})}export{Q as default};
