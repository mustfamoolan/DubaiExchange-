import{r as n,j as e,d as _e}from"./app-fn85VvU1.js";import{E as Ce}from"./EmployeeLayout-lzwIr8_v.js";import{u as Se,T as ke}from"./ThermalReceipt-Bhem9tNP.js";import{u as Te,R as Ee}from"./ReceiveExchangeThermalReceipt-CO-ADf5d.js";import{u as De}from"./useCentralCashBalance-CxsZrvhn.js";import{u as Re}from"./useCentralDollarBalance-C1i0uihj.js";import{g as Le}from"./generateUniqueReference-C4F3JMbQ.js";import{u as Me,N as Oe}from"./useNotification-JF5MUNZO.js";/* empty css            */function Je({user:w,currentBalance:Q=0,openingBalance:Fe=0,transactions:Ae=[],quickReport:b={exchanged_today:0,operations:0,total_exchanged:0,total_received:0},currentCashBalance:z=0,currentCentralDollarBalance:J=0,openingCashBalance:D=0}){const{centralCashBalance:U,updateBalanceAfterTransaction:R}=De(z),{centralDollarBalance:H,updateBalanceAfterTransaction:L}=Re(J),[Be,Ie]=n.useState(Q),[V,M]=n.useState(!1),[u,O]=n.useState({exchanged_today:b.exchanged_today,operations:b.operations,total_exchanged:b.total_exchanged,total_received:b.total_received}),{showReceipt:Y,receiptData:F,printReceipt:Z,closeReceipt:ee}=Se(),{showReceipt:te,receiptData:A,createReceiptAndSave:se,printReceipt:re,closeReceipt:ae}=Te(),{notification:h,showSuccess:B,showError:f,showWarning:I,closeNotification:ne}=Me(),[r,c]=n.useState({invoiceNumber:"",currentTime:new Date().toLocaleString("ar-EG"),amount:"",currency:"دينار عراقي",description:"",employeeName:w?.name||"الموظف الحالي",paidTo:"",selectedCustomer:null,notes:""}),[i,$]=n.useState("normal"),[d,y]=n.useState(""),[_,q]=n.useState([]),[C,j]=n.useState([]),[S,m]=n.useState(!1),[oe,X]=n.useState(!1),[le,N]=n.useState(!1),[o,g]=n.useState({name:"",phone:"",opening_balance_iqd:"0",opening_balance_usd:"0"}),[v,P]=n.useState(!1),[G,k]=n.useState(""),[ce,ie]=n.useState("");n.useEffect(()=>{const t=()=>{const l=new Date().toLocaleString("en-US",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit"});ie(l)};t();const s=setInterval(t,1e3);return()=>clearInterval(s)},[]),n.useEffect(()=>{(()=>{const s=Le(w?.id);k(s)})()},[]),n.useEffect(()=>{c(t=>({...t,invoiceNumber:G}))},[G]);const de=t=>{if(!t)return"";const s=t.toString().replace(/,/g,"");if(isNaN(s)||s==="")return t;const x=parseFloat(s).toString().split(".");return x[0]=x[0].replace(/\B(?=(\d{3})+(?!\d))/g,","),x.join(".")},me=t=>t.toString().replace(/,/g,""),ue=(t,s)=>{const a=me(s);(a===""||/^\d*\.?\d*$/.test(a))&&c(l=>({...l,[t]:a}))},T=(t,s)=>{c(a=>({...a,[t]:s}))},xe=async()=>{X(!0);try{const t=await fetch("/api/employee/customers/search",{method:"GET",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]')?.getAttribute("content")}});if(t.ok){const s=await t.json();q(s.customers||[]),j(s.customers||[])}}catch(t){console.error("Error fetching customers:",t)}finally{X(!1)}},he=t=>{if(y(t),c(a=>({...a,paidTo:t,selectedCustomer:null})),t.trim()===""){j(_),m(!1);return}const s=_.filter(a=>a.name.toLowerCase().includes(t.toLowerCase())||a.phone.includes(t)||a.customer_code.toLowerCase().includes(t.toLowerCase()));j(s),m(!0)},K=t=>{c(s=>({...s,paidTo:t.name,selectedCustomer:t})),y(t.name),m(!1)},ge=async()=>{try{console.log("إضافة عميل جديد - البيانات المرسلة:",{name:o.name,phone:o.phone,opening_balance_iqd:o.opening_balance_iqd||"0",opening_balance_usd:o.opening_balance_usd||"0"});const t=await fetch("/api/employee/customers",{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]')?.getAttribute("content")},body:JSON.stringify({name:o.name,phone:o.phone,opening_balance_iqd:o.opening_balance_iqd||"0",opening_balance_usd:o.opening_balance_usd||"0"})});if(console.log("استجابة الخادم - حالة:",t.status),t.ok){const s=await t.json();console.log("نجح إنشاء العميل:",s);const a=s.customer;q(l=>[a,...l]),j(l=>[a,...l]),K(a),N(!1),g({name:"",phone:"",opening_balance_iqd:"0",opening_balance_usd:"0"}),B("نجاح العملية","تم إضافة العميل بنجاح!")}else{const s=await t.json();console.error("خطأ في إنشاء العميل:",s),f("خطأ",s.message||"حدث خطأ في إضافة العميل")}}catch(t){console.error("خطأ في الشبكة:",t),f("خطأ في الشبكة","حدث خطأ في الشبكة")}},W=()=>{g(t=>({...t,name:d})),N(!0),m(!1)};n.useEffect(()=>{xe()},[]),n.useEffect(()=>{const t=s=>{S&&!s.target.closest(".relative")&&m(!1)};return document.addEventListener("mousedown",t),()=>{document.removeEventListener("mousedown",t)}},[S]);const[p,pe]=n.useState(null),be=async()=>{try{const t=await fetch("/employee/exchange/detailed-report",{method:"GET",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]').getAttribute("content")}});if(t.ok){const s=await t.json();return pe(s),s}else return console.error("فشل في جلب التقرير المفصل"),null}catch(t){return console.error("خطأ في جلب التقرير:",t),null}},fe=async()=>{M(!0),p||await be()},ye=async()=>{if(!r.amount||!r.description)throw new Error("يرجى ملء جميع الحقول المطلوبة");if(parseFloat(r.amount)<=0)throw new Error("يرجى إدخال مبلغ صحيح");const t=await fetch("/employee/exchange",{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]').getAttribute("content")},body:JSON.stringify({invoiceNumber:r.invoiceNumber,amount:r.amount,currency:r.currency,description:r.description,paidTo:r.paidTo,selectedCustomer:r.selectedCustomer,notes:r.notes})});if(t.ok){const s=await t.json();s.new_cash_balance!==void 0&&R(s.new_cash_balance),s.new_central_dollar_balance!==void 0&&L(s.new_central_dollar_balance),s.updated_report&&O({exchanged_today:s.updated_report.exchanged_today,operations:s.updated_report.operations,total_exchanged:s.updated_report.total_exchanged,total_received:s.updated_report.total_received}),c(E=>({...E,amount:"",currency:"دينار عراقي",description:"",paidTo:"",notes:"",currentTime:new Date().toLocaleString("ar-EG")}));const a=new Date,l=a.getFullYear().toString()+(a.getMonth()+1).toString().padStart(2,"0")+a.getDate().toString().padStart(2,"0"),x=Math.floor(Math.random()*1e3).toString().padStart(3,"0");return k(`EXC${l}${x}`),s}else{const s=await t.json();throw new Error(s.message||"حدث خطأ")}},je=async()=>{if(!r.amount||!r.description){I("تحذير","يرجى ملء جميع الحقول المطلوبة");return}if(parseFloat(r.amount)<=0){I("تحذير","يرجى إدخال مبلغ صحيح");return}P(!0);try{const t=await fetch("/employee/exchange",{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]').getAttribute("content")},body:JSON.stringify({invoiceNumber:r.invoiceNumber,amount:r.amount,currency:r.currency,description:r.description,paidTo:r.paidTo,selectedCustomer:r.selectedCustomer,notes:r.notes})});if(t.ok){const s=await t.json();s.new_cash_balance!==void 0&&R(s.new_cash_balance),s.new_central_dollar_balance!==void 0&&L(s.new_central_dollar_balance),s.updated_report&&O({exchanged_today:s.updated_report.exchanged_today,operations:s.updated_report.operations,total_exchanged:s.updated_report.total_exchanged,total_received:s.updated_report.total_received}),c(E=>({...E,amount:"",currency:"دينار عراقي",description:"",paidTo:"",selectedCustomer:null,notes:"",currentTime:new Date().toLocaleString("ar-EG")})),y(""),m(!1);const a=new Date,l=a.getFullYear().toString()+(a.getMonth()+1).toString().padStart(2,"0")+a.getDate().toString().padStart(2,"0"),x=Math.floor(Math.random()*1e3).toString().padStart(3,"0");return k(`EXC${l}${x}`),B("نجاح العملية","تم حفظ سند الصرف بنجاح!"),s}else{const s=await t.json();return f("خطأ",s.message||"حدث خطأ"),{success:!1,error:s.message}}}catch(t){return console.error("Error:",t),f("خطأ في الشبكة","حدث خطأ في الشبكة"),{success:!1,error:t.message}}finally{P(!1)}},Ne=async()=>{if(!r.amount||!r.description){alert("يرجى ملء جميع الحقول المطلوبة");return}if(i==="customer"&&!r.selectedCustomer&&!r.paidTo){alert("يرجى اختيار عميل أو إدخال اسم المستلم");return}const t=await se(ye,{reference_number:r.invoiceNumber,employee_name:w?.name||"الموظف الحالي",person_name:i==="customer"?r.selectedCustomer?r.selectedCustomer.name:r.paidTo:"صرف عادي",currency:r.currency,amount:r.amount,exchange_rate:"1",amount_in_iqd:parseFloat(r.amount),beneficiary:i==="customer"?r.selectedCustomer?r.selectedCustomer.name:r.paidTo:"صرف عادي",description:r.description,notes:r.notes||""},"exchange");t&&t.success&&console.log("تم حفظ سند الصرف وإنشاء الفاتورة المخصصة بنجاح")},ve=async()=>{await je()},we=()=>{_e.visit("/employee/dashboard")};return e.jsxs(Ce,{title:"عمليات الصرف",children:[e.jsxs("div",{className:"max-w-7xl mx-auto",children:[e.jsx("div",{className:"mb-6",children:e.jsxs("button",{onClick:we,className:"flex items-center gap-2 px-6 py-3 bg-blue-600 hover:bg-blue-700 text-white font-semibold rounded-lg transition-colors duration-200 shadow-md",children:[e.jsx("span",{children:"←"}),e.jsx("span",{children:"العودة للصفحة الرئيسية"})]})}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsx("div",{className:"lg:col-span-1",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-sm border border-gray-200 p-6",children:[e.jsxs("div",{className:"text-center mb-6",children:[e.jsx("div",{className:"w-20 h-20 bg-red-100 rounded-full flex items-center justify-center mx-auto mb-3",children:e.jsx("span",{className:"text-2xl text-red-600",children:"💸"})}),e.jsx("h2",{className:"text-xl font-bold text-gray-900",children:"سند الصرف"})]}),e.jsxs("div",{className:"space-y-4 mb-6",children:[e.jsxs("div",{className:"bg-green-50 rounded-xl p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-green-800 mb-2",children:"الرصيد النقدي المركزي"}),e.jsxs("p",{className:"text-3xl font-bold text-green-700",children:[Math.floor(U).toLocaleString()," د.ع"]})]}),e.jsxs("div",{className:"bg-purple-50 rounded-xl p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-purple-800 mb-2",children:"الرصيد المركزي للدولار"}),e.jsxs("p",{className:"text-3xl font-bold text-purple-700",children:["$",Math.floor(H).toLocaleString()]})]}),e.jsx("div",{className:"bg-gray-50 rounded-xl p-4",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm font-medium text-gray-700",children:"الرصيد الافتتاحي:"}),e.jsxs("span",{className:"font-bold text-gray-800",children:[D>0?Math.floor(D).toLocaleString():"0"," د.ع"]})]})})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-4",children:"تقرير شامل - جميع العمليات"}),e.jsx("div",{className:"bg-green-50 rounded-lg p-4",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm text-green-700",children:"إجمالي المستلم:"}),e.jsxs("span",{className:"font-bold text-green-800",children:[u.total_received>0?Math.floor(u.total_received).toLocaleString():"0"," د.ع"]})]})}),e.jsx("div",{className:"bg-red-50 rounded-lg p-4",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm text-red-700",children:"مصروف اليوم:"}),e.jsxs("span",{className:"font-bold text-red-800",children:[u.exchanged_today>0?Math.floor(u.exchanged_today).toLocaleString():"0"," د.ع"]})]})}),e.jsx("div",{className:"bg-blue-50 rounded-lg p-4",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm text-blue-700",children:"إجمالي المصروف:"}),e.jsxs("span",{className:"font-bold text-blue-800",children:[u.total_exchanged>0?Math.floor(u.total_exchanged).toLocaleString():"0"," د.ع"]})]})}),e.jsx("div",{className:"bg-gray-50 rounded-lg p-4",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm text-gray-700",children:"العمليات:"}),e.jsx("span",{className:"font-bold text-gray-800",children:u.operations})]})})]}),e.jsx("button",{onClick:fe,className:"w-full bg-blue-500 hover:bg-blue-600 text-white font-semibold py-3 px-4 rounded-xl transition-colors duration-200 mt-6",children:"تقرير مفصل"})]})}),e.jsx("div",{className:"lg:col-span-2",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-sm border border-gray-200 p-6",children:[e.jsx("div",{className:"text-center mb-8",children:e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"سند صرف"})}),e.jsxs("div",{className:"flex mb-6",children:[e.jsx("button",{onClick:()=>{$("normal"),c(t=>({...t,paidTo:"",selectedCustomer:null})),y(""),m(!1)},className:`flex-1 py-3 px-6 rounded-r-lg font-semibold transition-colors duration-200 ${i==="normal"?"bg-red-500 text-white":"bg-gray-200 text-gray-700 hover:bg-gray-300"}`,children:"صرف عادي"}),e.jsx("button",{onClick:()=>$("customer"),className:`flex-1 py-3 px-6 rounded-l-lg font-semibold transition-colors duration-200 ${i==="customer"?"bg-red-500 text-white":"bg-gray-200 text-gray-700 hover:bg-gray-300"}`,children:"صرف لعميل"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2 text-right",children:"الوقت:"}),e.jsx("input",{type:"text",className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-transparent text-right bg-gray-50",value:ce,readOnly:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2 text-right",children:"رقم الفاتورة:"}),e.jsx("input",{type:"text",className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-transparent text-right bg-gray-50",value:r.invoiceNumber,readOnly:!0})]})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2 text-right",children:"اسم مدخل البيانات:"}),e.jsx("input",{type:"text",className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-transparent text-right bg-gray-50",value:r.employeeName,readOnly:!0})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2 text-right",children:"المبلغ: *"}),e.jsx("input",{type:"text",className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-transparent text-right",placeholder:r.currency==="دولار أمريكي"?"أدخل المبلغ بالدولار":"أدخل المبلغ بالدينار العراقي",value:r.amount?de(r.amount):"",onChange:t=>ue("amount",t.target.value)})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2 text-right",children:"العملة: *"}),e.jsxs("select",{className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-transparent text-right",value:r.currency,onChange:t=>T("currency",t.target.value),children:[e.jsx("option",{value:"دينار عراقي",children:"دينار عراقي"}),e.jsx("option",{value:"دولار أمريكي",children:"دولار أمريكي"})]})]}),e.jsxs("div",{className:"mb-8",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2 text-right",children:"وصف السبب الدفع: *"}),e.jsx("textarea",{className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-transparent text-right",rows:"4",placeholder:"اكتب سبب الدفع والتفاصيل...",value:r.description,onChange:t=>T("description",t.target.value)})]}),i==="customer"&&e.jsxs("div",{className:"mb-6 relative",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2 text-right",children:"صُرف للسيد: *"}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"text",className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-transparent text-right",placeholder:"ابحث عن عميل أو أدخل اسم جديد...",value:d,onChange:t=>he(t.target.value),onFocus:()=>{_.length>0&&d&&m(!0)}}),oe&&e.jsx("div",{className:"absolute left-3 top-1/2 transform -translate-y-1/2",children:e.jsx("div",{className:"animate-spin h-4 w-4 border-2 border-red-500 border-t-transparent rounded-full"})}),r.selectedCustomer&&e.jsx("div",{className:"absolute left-3 top-1/2 transform -translate-y-1/2",children:e.jsx("div",{className:"w-2 h-2 bg-red-500 rounded-full"})})]}),S&&e.jsx("div",{className:"absolute z-10 w-full mt-1 bg-white border border-gray-300 rounded-lg shadow-lg max-h-60 overflow-y-auto",children:C.length>0?e.jsxs(e.Fragment,{children:[C.map(t=>e.jsx("div",{className:"px-4 py-2 hover:bg-gray-100 cursor-pointer border-b border-gray-100 text-right",onClick:()=>K(t),children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("div",{className:"text-left",children:e.jsx("span",{className:"text-xs text-gray-500",children:t.customer_code})}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-gray-900",children:t.name}),e.jsx("div",{className:"text-sm text-gray-600",children:t.phone})]})]})},t.id)),d&&!C.some(t=>t.name.toLowerCase()===d.toLowerCase())&&e.jsxs("div",{className:"px-4 py-3 bg-red-50 hover:bg-red-100 cursor-pointer border-t border-red-200 text-center text-red-700 font-medium",onClick:W,children:[e.jsx("svg",{className:"w-4 h-4 inline-block ml-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})}),'إضافة عميل جديد: "',d,'"']})]}):d?e.jsxs("div",{className:"px-4 py-3 bg-red-50 hover:bg-red-100 cursor-pointer text-center text-red-700 font-medium",onClick:W,children:[e.jsx("svg",{className:"w-4 h-4 inline-block ml-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})}),'إضافة عميل جديد: "',d,'"']}):e.jsx("div",{className:"px-4 py-3 text-center text-gray-500",children:"لا توجد عملاء"})}),r.selectedCustomer&&e.jsxs("div",{className:"mt-2 p-3 bg-red-50 border border-red-200 rounded-lg text-right",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("div",{className:"text-left",children:e.jsx("span",{className:"text-xs font-medium text-red-700",children:r.selectedCustomer.customer_code})}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-red-900",children:r.selectedCustomer.name}),e.jsx("div",{className:"text-sm text-red-700",children:r.selectedCustomer.phone})]})]}),e.jsxs("div",{className:"mt-2 grid grid-cols-2 gap-2 text-xs",children:[e.jsxs("div",{className:"text-center bg-white p-2 rounded",children:[e.jsx("div",{className:"text-gray-600",children:"الرصيد USD"}),e.jsxs("div",{className:"font-bold text-red-700",children:["$",r.selectedCustomer.current_usd_balance||"0.00"]})]}),e.jsxs("div",{className:"text-center bg-white p-2 rounded",children:[e.jsx("div",{className:"text-gray-600",children:"الرصيد IQD"}),e.jsxs("div",{className:"font-bold text-red-700",children:[parseInt(r.selectedCustomer.current_iqd_balance||0).toLocaleString()," د.ع"]})]})]})]})]}),e.jsxs("div",{className:"mb-8",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2 text-right",children:"ملاحظات إضافية:"}),e.jsx("textarea",{className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-transparent text-right",rows:"2",placeholder:"ملاحظات أخرى...",value:r.notes,onChange:t=>T("notes",t.target.value)})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("button",{onClick:Ne,disabled:v||!r.amount||!r.description||i==="customer"&&!r.selectedCustomer&&!r.paidTo,className:"bg-blue-500 hover:bg-blue-600 disabled:bg-gray-400 text-white font-semibold py-3 px-6 rounded-xl transition-colors duration-200 flex items-center justify-center",children:[e.jsx("span",{className:"ml-2",children:"🖨️"}),v?"جاري المعالجة...":"حفظ وطباعة"]}),e.jsxs("button",{onClick:ve,disabled:v||!r.amount||!r.description||i==="customer"&&!r.selectedCustomer&&!r.paidTo,className:"bg-red-500 hover:bg-red-600 disabled:bg-gray-400 text-white font-semibold py-3 px-6 rounded-xl transition-colors duration-200 flex items-center justify-center",children:[e.jsx("span",{className:"ml-2",children:"💾"}),v?"جاري المعالجة...":"حفظ"]})]})]})})]})]}),Y&&F&&e.jsx(ke,{receiptData:F,onClose:ee,onPrint:Z}),te&&A&&e.jsx(Ee,{receiptData:A,receiptType:"exchange",onClose:ae,onPrint:re}),V&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-xl max-w-4xl w-full max-h-[90vh] overflow-y-auto",children:[e.jsx("div",{className:"p-6 border-b border-gray-200",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h2",{className:"text-xl font-bold text-gray-900",children:"التقرير المفصل - سندات الصرف"}),e.jsx("button",{onClick:()=>M(!1),className:"text-gray-500 hover:text-gray-700 text-2xl",children:"×"})]})}),e.jsx("div",{className:"p-6",children:p?e.jsxs("div",{children:[e.jsxs("div",{className:"mb-6 grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"bg-red-50 p-4 rounded-lg",children:[e.jsx("h3",{className:"font-semibold text-red-800",children:"إجمالي المصروف"}),e.jsxs("p",{className:"text-2xl font-bold text-red-700",children:[p.summary?.total_amount?.toLocaleString()||"0"," د.ع"]})]}),e.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg",children:[e.jsx("h3",{className:"font-semibold text-blue-800",children:"عدد العمليات"}),e.jsx("p",{className:"text-2xl font-bold text-blue-700",children:p.summary?.total_transactions||0})]})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full table-auto",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-2 text-right",children:"رقم الفاتورة"}),e.jsx("th",{className:"px-4 py-2 text-right",children:"المبلغ"}),e.jsx("th",{className:"px-4 py-2 text-right",children:"الوصف"}),e.jsx("th",{className:"px-4 py-2 text-right",children:"التاريخ"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-200",children:p.transactions?.map((t,s)=>e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-4 py-2",children:t.invoice_number}),e.jsxs("td",{className:"px-4 py-2 font-semibold",children:[Number(t.amount).toLocaleString()," د.ع"]}),e.jsx("td",{className:"px-4 py-2",children:t.description}),e.jsx("td",{className:"px-4 py-2",children:t.formatted_date})]},s))})]})})]}):e.jsxs("div",{className:"text-center py-8",children:[e.jsx("div",{className:"inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-blue-500"}),e.jsx("p",{className:"mt-2 text-gray-600",children:"جاري تحميل التقرير..."})]})})]})}),le&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:e.jsx("div",{className:"bg-white rounded-lg max-w-md w-full max-h-[90vh] overflow-y-auto",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("button",{onClick:()=>N(!1),className:"text-gray-400 hover:text-gray-600",children:e.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})}),e.jsx("h2",{className:"text-xl font-bold text-gray-900",children:"إضافة عميل جديد"})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2 text-right",children:"اسم العميل: *"}),e.jsx("input",{type:"text",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-transparent text-right",placeholder:"أدخل اسم العميل",value:o.name,onChange:t=>g(s=>({...s,name:t.target.value}))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2 text-right",children:"رقم الهاتف: *"}),e.jsx("input",{type:"tel",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-transparent text-right",placeholder:"أدخل رقم الهاتف",value:o.phone,onChange:t=>g(s=>({...s,phone:t.target.value}))})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2 text-right",children:"الرصيد الافتتاحي USD"}),e.jsx("input",{type:"number",step:"0.01",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-transparent text-right",placeholder:"0.00 (يمكن أن يكون سالب)",value:o.opening_balance_usd,onChange:t=>g(s=>({...s,opening_balance_usd:t.target.value}))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2 text-right",children:"الرصيد الافتتاحي IQD"}),e.jsx("input",{type:"number",step:"1",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-transparent text-right",placeholder:"0 (يمكن أن يكون سالب)",value:o.opening_balance_iqd,onChange:t=>g(s=>({...s,opening_balance_iqd:t.target.value}))})]})]}),e.jsxs("div",{className:"flex space-x-3 space-x-reverse pt-4",children:[e.jsx("button",{onClick:()=>N(!1),className:"flex-1 px-4 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50 transition-colors",children:"إلغاء"}),e.jsx("button",{onClick:ge,disabled:!o.name||!o.phone,className:"flex-1 px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:"إضافة العميل"})]})]})]})})}),e.jsx(Oe,{isOpen:h.isOpen,type:h.type,title:h.title,message:h.message,autoClose:h.autoClose,autoCloseDelay:h.autoCloseDelay,onClose:ne})]})}export{Je as default};
